<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–°–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å—Ç—Ä–æ–∏—Ç–µ–ª—å–Ω—ã–º–∏ –ø—Ä–æ–µ–∫—Ç–∞–º–∏</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }

        /* –í–µ—Ä—Ö–Ω—è—è –ø–∞–Ω–µ–ª—å –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ */
        .top-navbar {
            background: white;
            padding: 15px 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            position: sticky;
            top: 0;
            z-index: 1000;
        }

        .navbar-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .navbar-row:last-child {
            margin-bottom: 0;
        }

        .brand {
            font-size: 20px;
            font-weight: bold;
            color: #333;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .top-actions {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .global-search-container {
            display: flex;
            align-items: center;
            gap: 15px;
            flex: 1;
            max-width: 1200px;
        }

        .search-input {
            flex: 1;
            min-width: 250px;
            padding: 10px 15px;
            border: 2px solid #e9ecef;
            border-radius: 25px;
            font-size: 14px;
            transition: border-color 0.3s ease;
        }

        .search-input:focus {
            outline: none;
            border-color: #667eea;
        }

        .filters-group {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
        }

        .filter-btn {
            padding: 8px 15px;
            border: 2px solid #dee2e6;
            background: white;
            border-radius: 20px;
            cursor: pointer;
            font-size: 12px;
            transition: all 0.3s ease;
            white-space: nowrap;
            font-weight: 500;
        }

        .filter-btn:hover {
            border-color: #667eea;
            background: #f8f9fa;
        }

        .filter-btn.active {
            background: #667eea;
            color: white;
            border-color: #667eea;
        }

        /* –ù–∏–∂–Ω—è—è –ø–∞–Ω–µ–ª—å */
        .bottom-navbar {
            background: rgba(255, 255, 255, 0.95);
            padding: 10px 20px;
            box-shadow: 0 -2px 10px rgba(0,0,0,0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
            backdrop-filter: blur(10px);
        }

        .project-info {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .project-select {
            padding: 10px 15px;
            border: 2px solid #dee2e6;
            border-radius: 8px;
            background: white;
            font-size: 14px;
            min-width: 250px;
            font-weight: 500;
        }

        .project-meta {
            color: #6c757d;
            font-size: 12px;
        }

        /* –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä */
        .container {
            max-width: 1600px;
            margin: 0 auto;
            padding: 20px;
        }

        /* –î–∞—à–±–æ—Ä–¥ */
        .dashboard {
            background: white;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }

        .dashboard-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .dashboard-title {
            font-size: 24px;
            color: #333;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .dashboard-actions {
            display: flex;
            gap: 10px;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .stat-card {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 20px;
            border-radius: 12px;
            text-align: center;
            transition: transform 0.3s ease;
        }

        .stat-card:hover {
            transform: translateY(-2px);
        }

        .stat-number {
            font-size: 28px;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 13px;
            opacity: 0.9;
        }

        /* –†–∞–±–æ—á–∞—è –æ–±–ª–∞—Å—Ç—å */
        .main-workspace {
            display: grid;
            grid-template-columns: 350px 1fr;
            gap: 20px;
            min-height: 600px;
        }

        /* –ë–æ–∫–æ–≤–∞—è –ø–∞–Ω–µ–ª—å */
        .sidebar {
            background: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            overflow-y: auto;
            max-height: 80vh;
        }

        .sidebar-section {
            margin-bottom: 25px;
        }

        .sidebar-title {
            font-size: 16px;
            font-weight: bold;
            color: #333;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .tree-project {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            margin-bottom: 10px;
            overflow: hidden;
        }

        .tree-project-header {
            padding: 15px;
            background: #e9ecef;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: background 0.3s ease;
        }

        .tree-project-header:hover {
            background: #dee2e6;
        }

        .tree-project.active .tree-project-header {
            background: #667eea;
            color: white;
        }

        .tree-project-name {
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .tree-blocks {
            display: none;
            padding: 10px;
        }

        .tree-project.active .tree-blocks {
            display: block;
        }

        .tree-block {
            background: white;
            border: 1px solid #dee2e6;
            border-radius: 6px;
            margin-bottom: 8px;
            overflow: hidden;
        }

        .tree-block-header {
            padding: 12px;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: background 0.3s ease;
        }

        .tree-block-header:hover {
            background: #f8f9fa;
        }

        .tree-block.active .tree-block-header {
            background: #e3f2fd;
            color: #1976d2;
        }

        .tree-floors {
            display: none;
            padding: 10px;
            background: #f8f9fa;
        }

        .tree-block.active .tree-floors {
            display: block;
        }

        .tree-floor {
            padding: 8px 12px;
            margin: 3px 0;
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .tree-floor:hover {
            background: #e3f2fd;
        }

        .tree-floor.selected {
            background: #1976d2;
            color: white;
        }

        /* –û–±–ª–∞—Å—Ç—å –∫–æ–Ω—Ç–µ–Ω—Ç–∞ */
        .content-area {
            background: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            overflow-y: auto;
            max-height: 80vh;
        }

        .content-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid #e9ecef;
        }

        .content-title {
            font-size: 20px;
            color: #333;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .content-actions {
            display: flex;
            gap: 10px;
        }

        /* –°–µ—Ç–∫–∞ —Ä–∞–±–æ—Ç */
        .works-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(400px, 1fr));
            gap: 15px;
        }

        .work-card {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 12px;
            padding: 20px;
            transition: all 0.3s ease;
            position: relative;
            border-left: 4px solid #dee2e6;
        }

        .work-card:hover {
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
            transform: translateY(-3px);
        }

        /* –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–µ —Ü–≤–µ—Ç–∞ –¥–ª—è —Ä–∞–±–æ—Ç */
        .work-card.tech-order-1 { border-left-color: #e53e3e; }
        .work-card.tech-order-2 { border-left-color: #fd7900; }
        .work-card.tech-order-3 { border-left-color: #fbb917; }
        .work-card.tech-order-4 { border-left-color: #38a169; }
        .work-card.tech-order-5 { border-left-color: #3182ce; }
        .work-card.tech-order-6 { border-left-color: #805ad5; }
        .work-card.tech-order-7 { border-left-color: #9c88ff; }
        .work-card.tech-order-8 { border-left-color: #48bb78; }
        .work-card.tech-order-9 { border-left-color: #ed8936; }
        .work-card.tech-order-10 { border-left-color: #38b2ac; }
        .work-card.tech-order-11 { border-left-color: #667eea; }
        .work-card.tech-order-12 { border-left-color: #e53e3e; }
        .work-card.tech-order-13 { border-left-color: #718096; }
        .work-card.tech-order-14 { border-left-color: #4a5568; }
        .work-card.tech-order-15 { border-left-color: #2d3748; }
        .work-card.tech-order-16 { border-left-color: #1a202c; }
        .work-card.tech-order-17 { border-left-color: #e53e3e; }
        .work-card.tech-order-18 { border-left-color: #718096; }
        .work-card.tech-order-19 { border-left-color: #fd7900; }
        .work-card.tech-order-20 { border-left-color: #38a169; }

        .work-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 15px;
        }

        .work-title {
            font-weight: bold;
            color: #333;
            font-size: 16px;
            line-height: 1.3;
        }

        .work-actions {
            display: flex;
            gap: 5px;
        }

        .work-details {
            margin-bottom: 15px;
        }

        .work-detail {
            display: flex;
            justify-content: space-between;
            margin: 8px 0;
            font-size: 14px;
        }

        .work-detail-label {
            color: #6c757d;
            font-weight: 500;
        }

        .work-detail-value {
            color: #333;
            font-weight: 600;
        }

        .tech-order-badge {
            display: inline-block;
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: bold;
            color: white;
            margin-left: 8px;
        }

        .category-badge {
            display: inline-block;
            padding: 2px 6px;
            border-radius: 8px;
            font-size: 10px;
            font-weight: bold;
            color: white;
            margin-left: 5px;
            opacity: 0.8;
        }

        .progress-section {
            margin-top: 15px;
        }

        .progress-bar {
            width: 100%;
            height: 24px;
            background: #e9ecef;
            border-radius: 12px;
            overflow: hidden;
            cursor: pointer;
            margin: 8px 0;
            position: relative;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #28a745, #20c997);
            transition: width 0.4s ease;
            border-radius: 12px;
        }

        .progress-text {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 12px;
            font-weight: bold;
            color: #333;
            text-shadow: 1px 1px 2px rgba(255,255,255,0.8);
        }

        /* –°—Ç–∞—Ç—É—Å—ã */
        .status-controls {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 5px;
            margin-top: 10px;
        }

        .status-btn {
            padding: 6px 8px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 11px;
            font-weight: 500;
            transition: all 0.3s ease;
            text-align: center;
        }

        .status-not-started {
            background: #f8f9fa;
            color: #6c757d;
            border: 1px solid #dee2e6;
        }

        .status-not-started.active {
            background: #6c757d;
            color: white;
        }

        .status-in-progress {
            background: #fff3cd;
            color: #856404;
            border: 1px solid #ffeaa7;
        }

        .status-in-progress.active {
            background: #856404;
            color: white;
        }

        .status-completed {
            background: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }

        .status-completed.active {
            background: #0c5460;
            color: white;
        }

        .status-overdue {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f1b0b7;
        }

        .status-overdue.active {
            background: #721c24;
            color: white;
        }

        /* –ö–Ω–æ–ø–∫–∏ */
        .btn {
            padding: 8px 16px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 6px;
        }

        .btn-primary {
            background: #667eea;
            color: white;
        }

        .btn-success {
            background: #28a745;
            color: white;
        }

        .btn-danger {
            background: #dc3545;
            color: white;
        }

        .btn-warning {
            background: #ffc107;
            color: #333;
        }

        .btn-info {
            background: #17a2b8;
            color: white;
        }

        .btn-small {
            padding: 4px 8px;
            font-size: 12px;
        }

        /* –ü—É—Å—Ç–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ */
        .empty-state {
            text-align: center;
            padding: 80px 20px;
            color: #6c757d;
        }

        .empty-state-icon {
            font-size: 64px;
            margin-bottom: 20px;
        }

        .empty-state h3 {
            margin-bottom: 10px;
            font-size: 24px;
        }

        .empty-state p {
            margin-bottom: 20px;
            font-size: 16px;
        }

        /* –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ */
        .modal {
            display: none;
            position: fixed;
            z-index: 2000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background-color: white;
            padding: 30px;
            border-radius: 15px;
            width: 90%;
            max-width: 900px;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid #e9ecef;
        }

        .modal-title {
            font-size: 20px;
            color: #333;
        }

        .close {
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
            color: #999;
        }

        .close:hover {
            color: #333;
        }

        .form-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 20px;
        }

        .form-group {
            margin-bottom: 15px;
        }

        .form-group.full-width {
            grid-column: 1 / -1;
        }

        .form-label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
            color: #333;
        }

        .form-control {
            width: 100%;
            padding: 10px;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            font-size: 14px;
            transition: border-color 0.3s ease;
        }

        .form-control:focus {
            outline: none;
            border-color: #667eea;
        }

        /* –ö–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä –±–ª–æ–∫–æ–≤ */
        .block-constructor {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 10px;
        }

        .block-header {
            display: flex;
            gap: 10px;
            align-items: center;
            margin-bottom: 10px;
        }

        .floor-range {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .floor-range label {
            font-size: 12px;
            font-weight: bold;
        }

        .floor-range input {
            width: 80px;
            padding: 5px;
            border: 1px solid #dee2e6;
            border-radius: 4px;
        }

        /* –§–∏–ª—å—Ç—Ä—ã –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º */
        .category-filters {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
            margin-bottom: 15px;
        }

        .category-filter {
            padding: 6px 12px;
            border: 2px solid #dee2e6;
            background: white;
            border-radius: 15px;
            cursor: pointer;
            font-size: 11px;
            transition: all 0.3s ease;
            white-space: nowrap;
        }

        .category-filter:hover {
            border-color: #667eea;
        }

        .category-filter.active {
            background: #667eea;
            color: white;
            border-color: #667eea;
        }

        /* –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å */
        @media (max-width: 768px) {
            .navbar-row {
                flex-direction: column;
                gap: 10px;
                align-items: stretch;
            }

            .main-workspace {
                grid-template-columns: 1fr;
            }

            .sidebar {
                order: 2;
                max-height: none;
            }

            .content-area {
                order: 1;
                max-height: none;
            }

            .works-grid {
                grid-template-columns: 1fr;
            }

            .form-grid {
                grid-template-columns: 1fr;
            }
        }

        /* –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 20px;
            border-radius: 8px;
            color: white;
            font-weight: 500;
            z-index: 3000;
            transform: translateX(100%);
            transition: transform 0.3s ease;
        }

        .notification.show {
            transform: translateX(0);
        }

        .notification.success {
            background: #28a745;
        }

        .notification.error {
            background: #dc3545;
        }

        .notification.warning {
            background: #ffc107;
            color: #333;
        }
    </style>
</head>
<body>
    <!-- –í–µ—Ä—Ö–Ω—è—è –ø–∞–Ω–µ–ª—å –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ -->
    <div class="top-navbar">
        <div class="navbar-row">
            <div class="brand">
                üèóÔ∏è –°–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å—Ç—Ä–æ–∏—Ç–µ–ª—å–Ω—ã–º–∏ –ø—Ä–æ–µ–∫—Ç–∞–º–∏
            </div>
            <div class="top-actions">
                <button class="btn btn-success" onclick="addNewWork()">‚ûï –î–æ–±–∞–≤–∏—Ç—å —Ä–∞–±–æ—Ç—É</button>
                <button class="btn btn-primary" onclick="addNewProject()">üèóÔ∏è –ù–æ–≤—ã–π –ø—Ä–æ–µ–∫—Ç</button>
                <button class="btn btn-warning" onclick="exportData()">üì• –≠–∫—Å–ø–æ—Ä—Ç</button>
            </div>
        </div>

        <div class="navbar-row">
            <div class="global-search-container">
                <input type="text" class="search-input" id="globalSearchInput" placeholder="üîç –ü–æ–∏—Å–∫ –ø–æ —Ä–∞–±–æ—Ç–∞–º, –æ–±—ä–µ–∫—Ç–∞–º, —ç—Ç–∞–∂–∞–º, –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è–º...">
                
                <div class="filters-group">
                    <button class="filter-btn active" id="allWorksFilter" onclick="setGlobalFilter('all')">
                        üìã –í—Å–µ —Ä–∞–±–æ—Ç—ã
                    </button>
                    <button class="filter-btn" id="completedFilter" onclick="setGlobalFilter('completed')">
                        ‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ
                    </button>
                    <button class="filter-btn" id="notCompletedFilter" onclick="setGlobalFilter('not-completed')">
                        ‚è≥ –ù–µ–≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ
                    </button>
                    <button class="filter-btn" id="todayFilter" onclick="setGlobalFilter('today')">
                        üìÖ –°–µ–≥–æ–¥–Ω—è
                    </button>
                    <button class="filter-btn" id="overdueFilter" onclick="setGlobalFilter('overdue')">
                        üö® –ü—Ä–æ—Å—Ä–æ—á–µ–Ω–æ
                    </button>
                </div>
            </div>
        </div>

        <!-- –§–∏–ª—å—Ç—Ä—ã –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º —Ä–∞–±–æ—Ç -->
        <div class="navbar-row">
            <div class="category-filters" id="categoryFilters">
                <button class="category-filter active" onclick="setCategoryFilter('all')">–í—Å–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</button>
                <button class="category-filter" onclick="setCategoryFilter('–ß–µ—Ä–Ω–æ–≤—ã–µ —Ä–∞–±–æ—Ç—ã')">–ß–µ—Ä–Ω–æ–≤—ã–µ</button>
                <button class="category-filter" onclick="setCategoryFilter('–û—Ç–¥–µ–ª–æ—á–Ω—ã–µ —Ä–∞–±–æ—Ç—ã')">–û—Ç–¥–µ–ª–æ—á–Ω—ã–µ</button>
                <button class="category-filter" onclick="setCategoryFilter('–ü–æ—Ç–æ–ª–∫–∏')">–ü–æ—Ç–æ–ª–∫–∏</button>
                <button class="category-filter" onclick="setCategoryFilter('–ö–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏')">–ö–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏</button>
                <button class="category-filter" onclick="setCategoryFilter('–ó–∞–≤–µ—Ä—à–∞—é—â–∏–µ —Ä–∞–±–æ—Ç—ã')">–ó–∞–≤–µ—Ä—à–∞—é—â–∏–µ</button>
            </div>
        </div>
    </div>

    <!-- –ù–∏–∂–Ω—è—è –ø–∞–Ω–µ–ª—å -->
    <div class="bottom-navbar">
        <div class="project-info">
            <select class="project-select" id="activeProjectSelect" onchange="changeActiveProject()">
                <option value="all">üåê –í—Å–µ –ø—Ä–æ–µ–∫—Ç—ã</option>
            </select>
            <div class="project-meta" id="projectMeta">
                –í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–æ–µ–∫—Ç –¥–ª—è –¥–µ—Ç–∞–ª—å–Ω–æ–≥–æ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞
            </div>
        </div>
        
        <div>
            <button class="btn btn-primary" onclick="openProjectManager()">‚öôÔ∏è –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞–º–∏</button>
        </div>
    </div>

    <div class="container">
        <!-- –î–∞—à–±–æ—Ä–¥ -->
        <div class="dashboard">
            <div class="dashboard-header">
                <div class="dashboard-title">
                    <span id="dashboardIcon">üìä</span>
                    <span id="dashboardTitle">–û–±—â–∏–π –¥–∞—à–±–æ—Ä–¥ –≤—Å–µ—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤</span>
                </div>
                <div class="dashboard-actions">
                    <select class="form-control" id="sortBySelect" onchange="applySorting()" style="max-width: 200px;">
                        <option value="default">üìã –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é</option>
                        <option value="technology">üîß –ü–æ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏</option>
                        <option value="progress">üìä –ü–æ –ø—Ä–æ–≥—Ä–µ—Å—Å—É</option>
                        <option value="date">üìÖ –ü–æ –¥–∞—Ç–∞–º</option>
                        <option value="status">üè∑Ô∏è –ü–æ —Å—Ç–∞—Ç—É—Å—É</option>
                        <option value="floor">üè¢ –ü–æ —ç—Ç–∞–∂–∞–º</option>
                        <option value="category">üìÅ –ü–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º</option>
                    </select>
                </div>
            </div>
            
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-number" id="totalWorks">0</div>
                    <div class="stat-label">–í—Å–µ–≥–æ —Ä–∞–±–æ—Ç</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="visibleWorks">0</div>
                    <div class="stat-label">–ü–æ–∫–∞–∑–∞–Ω–æ —Ä–∞–±–æ—Ç</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="completedWorks">0</div>
                    <div class="stat-label">–ó–∞–≤–µ—Ä—à–µ–Ω–æ</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="inProgressWorks">0</div>
                    <div class="stat-label">–í –ø—Ä–æ—Ü–µ—Å—Å–µ</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="overdueWorks">0</div>
                    <div class="stat-label">–ü—Ä–æ—Å—Ä–æ—á–µ–Ω–æ</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="avgProgress">0%</div>
                    <div class="stat-label">–°—Ä–µ–¥–Ω–∏–π –ø—Ä–æ–≥—Ä–µ—Å—Å</div>
                </div>
            </div>
        </div>

        <!-- –û—Å–Ω–æ–≤–Ω–∞—è —Ä–∞–±–æ—á–∞—è –æ–±–ª–∞—Å—Ç—å -->
        <div class="main-workspace">
            <!-- –ë–æ–∫–æ–≤–∞—è –ø–∞–Ω–µ–ª—å –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ -->
            <div class="sidebar">
                <div class="sidebar-section">
                    <div class="sidebar-title">
                        üóÇÔ∏è –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–æ–≤
                    </div>
                    <div id="projectTree">
                        <!-- –î–µ—Ä–µ–≤–æ –ø—Ä–æ–µ–∫—Ç–æ–≤ –±—É–¥–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω–æ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                    </div>
                </div>

                <div class="sidebar-section">
                    <div class="sidebar-title">
                        üîß –ë—ã—Å—Ç—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è
                    </div>
                    <div style="display: flex; flex-direction: column; gap: 8px;">
                        <button class="btn btn-success" onclick="addNewWork()">‚ûï –î–æ–±–∞–≤–∏—Ç—å —Ä–∞–±–æ—Ç—É</button>
                        <button class="btn btn-primary" onclick="addNewProject()">üèóÔ∏è –ù–æ–≤—ã–π –ø—Ä–æ–µ–∫—Ç</button>
                        <button class="btn btn-warning" onclick="exportData()">üì• –≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö</button>
                        <button class="btn btn-info" onclick="generateReport()">üìä –°–æ–∑–¥–∞—Ç—å –æ—Ç—á–µ—Ç</button>
                    </div>
                </div>
            </div>

            <!-- –û–±–ª–∞—Å—Ç—å –∫–æ–Ω—Ç–µ–Ω—Ç–∞ -->
            <div class="content-area">
                <div class="content-header">
                    <div class="content-title" id="contentTitle">
                        üìã –í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–æ–µ–∫—Ç –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ —Ä–∞–±–æ—Ç
                    </div>
                    <div class="content-actions">
                        <button class="btn btn-success" onclick="addNewWork()">‚ûï –î–æ–±–∞–≤–∏—Ç—å —Ä–∞–±–æ—Ç—É</button>
                    </div>
                </div>
                
                <div id="worksContainer">
                    <div class="empty-state">
                        <div class="empty-state-icon">üèóÔ∏è</div>
                        <h3>–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ —Å–∏—Å—Ç–µ–º—É —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å—Ç—Ä–æ–∏—Ç–µ–ª—å–Ω—ã–º–∏ –ø—Ä–æ–µ–∫—Ç–∞–º–∏</h3>
                        <p>–°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π –ø—Ä–æ–µ–∫—Ç –∏–ª–∏ –≤—ã–±–µ—Ä–∏—Ç–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –¥–ª—è –Ω–∞—á–∞–ª–∞ —Ä–∞–±–æ—Ç—ã</p>
                        <button class="btn btn-primary" onclick="addNewProject()">üèóÔ∏è –°–æ–∑–¥–∞—Ç—å –ø–µ—Ä–≤—ã–π –ø—Ä–æ–µ–∫—Ç</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Ä–∞–±–æ—Ç—ã -->
    <div id="editModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title" id="modalTitle">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Ä–∞–±–æ—Ç—É</h2>
                <span class="close" onclick="closeModal('editModal')">&times;</span>
            </div>
            
            <form id="workForm">
                <div class="form-grid">
                    <div class="form-group">
                        <label class="form-label">–ü—Ä–æ–µ–∫—Ç</label>
                        <select class="form-control" id="editProject" required onchange="updateProjectFields()"></select>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">–ë–ª–æ–∫</label>
                        <select class="form-control" id="editBlock" required onchange="updateFloorOptions()"></select>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">–≠—Ç–∞–∂</label>
                        <select class="form-control" id="editFloor" required></select>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">–û–±—ä–µ–∫—Ç</label>
                        <select class="form-control" id="editObject" required></select>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">–ö–∞—Ç–µ–≥–æ—Ä–∏—è —Ä–∞–±–æ—Ç</label>
                        <select class="form-control" id="editCategory" onchange="updateWorkTypeOptions()">
                            <option value="">–í—Å–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">–í–∏–¥ —Ä–∞–±–æ—Ç—ã</label>
                        <select class="form-control" id="editWorkType" required></select>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">–ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å</label>
                        <input type="text" class="form-control" id="editExecutor" required>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">–î–∞—Ç–∞ –Ω–∞—á–∞–ª–∞</label>
                        <input type="date" class="form-control" id="editStartDate" required>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">–î–∞—Ç–∞ –æ–∫–æ–Ω—á–∞–Ω–∏—è</label>
                        <input type="date" class="form-control" id="editEndDate" required>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">–°—Ç–∞—Ç—É—Å</label>
                        <select class="form-control" id="editStatus" required>
                            <option value="not-started">–ù–µ –Ω–∞—á–∞—Ç–æ</option>
                            <option value="in-progress">–í –ø—Ä–æ—Ü–µ—Å—Å–µ</option>
                            <option value="completed">–ó–∞–≤–µ—Ä—à–µ–Ω–æ</option>
                            <option value="overdue">–ü—Ä–æ—Å—Ä–æ—á–µ–Ω–æ</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç</label>
                        <select class="form-control" id="editPriority">
                            <option value="low">–ù–∏–∑–∫–∏–π</option>
                            <option value="medium">–°—Ä–µ–¥–Ω–∏–π</option>
                            <option value="high">–í—ã—Å–æ–∫–∏–π</option>
                        </select>
                    </div>
                    
                    <div class="form-group full-width">
                        <label class="form-label">–ü—Ä–æ–≥—Ä–µ—Å—Å: <span id="progressValue">0</span>%</label>
                        <input type="range" class="form-control" id="editProgress" min="0" max="100" value="0" style="height: 10px;">
                    </div>

                    <div class="form-group full-width">
                        <label class="form-label">–ü—Ä–∏–º–µ—á–∞–Ω–∏—è</label>
                        <textarea class="form-control" id="editNotes" rows="3"></textarea>
                    </div>
                </div>
                
                <div style="display: flex; gap: 10px; justify-content: flex-end;">
                    <button type="button" class="btn btn-danger" onclick="closeModal('editModal')">–û—Ç–º–µ–Ω–∞</button>
                    <button type="submit" class="btn btn-success">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                </div>
            </form>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å–æ–∑–¥–∞–Ω–∏—è –ø—Ä–æ–µ–∫—Ç–∞ -->
    <div id="projectModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title" id="projectModalTitle">–°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π –ø—Ä–æ–µ–∫—Ç</h2>
                <span class="close" onclick="closeModal('projectModal')">&times;</span>
            </div>
            
            <form id="projectForm">
                <div class="form-grid">
                    <div class="form-group">
                        <label class="form-label">–ö–æ–¥ –ø—Ä–æ–µ–∫—Ç–∞ *</label>
                        <input type="text" class="form-control" id="projectCode" placeholder="–Ω–∞–ø—Ä–∏–º–µ—Ä: gulkevichi-1" required>
                        <small>–£–Ω–∏–∫–∞–ª—å–Ω—ã–π –∫–æ–¥ –¥–ª—è –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –ø—Ä–æ–µ–∫—Ç–∞</small>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">–ò–∫–æ–Ω–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞</label>
                        <select class="form-control" id="projectIcon">
                            <option value="üè¢">üè¢ –û—Ñ–∏—Å–Ω–æ–µ –∑–¥–∞–Ω–∏–µ</option>
                            <option value="üèóÔ∏è">üèóÔ∏è –°—Ç—Ä–æ–∏—Ç–µ–ª—å—Å—Ç–≤–æ</option>
                            <option value="üè≠">üè≠ –ü—Ä–æ–º—ã—à–ª–µ–Ω–Ω—ã–π –æ–±—ä–µ–∫—Ç</option>
                            <option value="üè†">üè† –ñ–∏–ª–æ–π –¥–æ–º</option>
                            <option value="üè´">üè´ –û–±—â–µ—Å—Ç–≤–µ–Ω–Ω–æ–µ –∑–¥–∞–Ω–∏–µ</option>
                            <option value="üè•">üè• –ú–µ–¥–∏—Ü–∏–Ω—Å–∫–æ–µ —É—á—Ä–µ–∂–¥–µ–Ω–∏–µ</option>
                            <option value="üè®">üè® –ì–æ—Å—Ç–∏–Ω–∏—Ü–∞</option>
                            <option value="üè™">üè™ –¢–æ—Ä–≥–æ–≤–æ–µ –∑–¥–∞–Ω–∏–µ</option>
                        </select>
                    </div>
                    
                    <div class="form-group full-width">
                        <label class="form-label">–ù–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞ *</label>
                        <input type="text" class="form-control" id="projectName" placeholder="–Ω–∞–ø—Ä–∏–º–µ—Ä: –ñ–ö –ì—É–ª—å–∫–µ–≤–∏—á–∏" required>
                    </div>
                    
                    <div class="form-group full-width">
                        <label class="form-label">–û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞</label>
                        <textarea class="form-control" id="projectDescription" rows="3" placeholder="–ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞, –µ–≥–æ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –∏ —Ü–µ–ª–∏"></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">–ó–∞–∫–∞–∑—á–∏–∫</label>
                        <input type="text" class="form-control" id="projectClient" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ –∑–∞–∫–∞–∑—á–∏–∫–∞">
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">–ü–æ–¥—Ä—è–¥—á–∏–∫</label>
                        <input type="text" class="form-control" id="projectContractor" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ –ø–æ–¥—Ä—è–¥—á–∏–∫–∞">
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">–ê–¥—Ä–µ—Å –æ–±—ä–µ–∫—Ç–∞</label>
                        <input type="text" class="form-control" id="projectAddress" placeholder="–ü–æ–ª–Ω—ã–π –∞–¥—Ä–µ—Å —Å—Ç—Ä–æ–∏—Ç–µ–ª—å–Ω–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞">
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">–î–∞—Ç–∞ –Ω–∞—á–∞–ª–∞ –ø—Ä–æ–µ–∫—Ç–∞</label>
                        <input type="date" class="form-control" id="projectStartDate">
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">–î–∞—Ç–∞ –æ–∫–æ–Ω—á–∞–Ω–∏—è –ø—Ä–æ–µ–∫—Ç–∞</label>
                        <input type="date" class="form-control" id="projectEndDate">
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">–ë—é–¥–∂–µ—Ç –ø—Ä–æ–µ–∫—Ç–∞ (—Ä—É–±.)</label>
                        <input type="number" class="form-control" id="projectBudget" placeholder="0">
                    </div>
                </div>
                
                <h3 style="margin: 20px 0 15px 0;">üè¢ –ö–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä –±–ª–æ–∫–æ–≤</h3>
                
                <div class="form-group full-width">
                    <label class="form-label">–ë–ª–æ–∫–∏ –ø—Ä–æ–µ–∫—Ç–∞</label>
                    <div id="blocksContainer">
                        <!-- –ë–ª–æ–∫–∏ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                    </div>
                    <button type="button" class="btn btn-success btn-small" onclick="addBlock()">‚ûï –î–æ–±–∞–≤–∏—Ç—å –±–ª–æ–∫</button>
                    <small style="color: #6c757d; display: block; margin-top: 5px;">–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –±–ª–æ–∫–∏ –∏ —ç—Ç–∞–∂–Ω–æ—Å—Ç—å –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –±–ª–æ–∫–∞ –æ—Ç–¥–µ–ª—å–Ω–æ</small>
                </div>
                
                <div class="form-group full-width">
                    <label class="form-label">–û–±—ä–µ–∫—Ç—ã (–ø–æ–º–µ—â–µ–Ω–∏—è)</label>
                    <textarea class="form-control" id="projectObjects" rows="3" placeholder="–ö–≤–∞—Ä—Ç–∏—Ä—ã, –ú–û–ü, –õ–∏—Ñ—Ç.—Ö–æ–ª–ª, –õ–µ—Å—Ç. –º., –≠–ª–µ–∫—Ç—Ä–æ—â–∏—Ç–æ–≤–∞—è, –í–ù–°, –ö–æ–º–º–µ—Ä—Ü–∏—è"></textarea>
                    <small style="color: #6c757d;">–¢–∏–ø—ã –ø–æ–º–µ—â–µ–Ω–∏–π/–æ–±—ä–µ–∫—Ç–æ–≤ —á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é</small>
                </div>
                
                <div style="display: flex; gap: 10px; justify-content: flex-end; margin-top: 20px;">
                    <button type="button" class="btn btn-danger" onclick="closeModal('projectModal')">–û—Ç–º–µ–Ω–∞</button>
                    <button type="submit" class="btn btn-success">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –ø—Ä–æ–µ–∫—Ç</button>
                </div>
            </form>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—Ä–æ–µ–∫—Ç–∞–º–∏ -->
    <div id="projectManagerModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">‚öôÔ∏è –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞–º–∏</h2>
                <span class="close" onclick="closeModal('projectManagerModal')">&times;</span>
            </div>
            
            <div style="display: grid; gap: 15px; max-width: 600px;">
                <div style="display: flex; gap: 10px; margin-bottom: 20px;">
                    <button class="btn btn-success" onclick="addNewProject()">‚ûï –°–æ–∑–¥–∞—Ç—å –ø—Ä–æ–µ–∫—Ç</button>
                    <button class="btn btn-warning" onclick="exportData()">üì• –≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö</button>
                    <button class="btn btn-info" onclick="generateReport()">üìä –°–æ–∑–¥–∞—Ç—å –æ—Ç—á–µ—Ç</button>
                </div>
                
                <div id="projectsList">
                    <!-- –°–ø–∏—Å–æ–∫ –ø—Ä–æ–µ–∫—Ç–æ–≤ –±—É–¥–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                </div>
            </div>
            
            <div style="display: flex; gap: 10px; justify-content: flex-end; margin-top: 20px;">
                <button class="btn btn-primary" onclick="closeModal('projectManagerModal')">–ó–∞–∫—Ä—ã—Ç—å</button>
            </div>
        </div>
    </div>

    <script>
        // === –û–ë–™–ï–î–ò–ù–ï–ù–ù–ê–Ø –ë–ê–ó–ê –î–ê–ù–ù–´–• –ò–ó –í–°–ï–• –ü–†–û–ï–ö–¢–û–í ===
        const workTypesDatabase = [
            { name: "–®—Ç—É–∫–∞—Ç—É—Ä–∫–∞", order: 1, color: "#e53e3e", category: "–ß–µ—Ä–Ω–æ–≤—ã–µ —Ä–∞–±–æ—Ç—ã" },
            { name: "–°—Ç—è–∂–∫–∞", order: 2, color: "#fd7900", category: "–ß–µ—Ä–Ω–æ–≤—ã–µ —Ä–∞–±–æ—Ç—ã" },
            { name: "–£—Ç–µ–ø–ª–∏—Ç–µ–ª—å", order: 3, color: "#fbb917", category: "–ß–µ—Ä–Ω–æ–≤—ã–µ —Ä–∞–±–æ—Ç—ã" },
            { name: "–®–ø–∞–∫–ª—ë–≤–∫–∞", order: 4, color: "#38a169", category: "–û—Ç–¥–µ–ª–æ—á–Ω—ã–µ —Ä–∞–±–æ—Ç—ã" },
            { name: "–®–ø–∞—Ç–ª—ë–≤–∫–∞", order: 4, color: "#38a169", category: "–û—Ç–¥–µ–ª–æ—á–Ω—ã–µ —Ä–∞–±–æ—Ç—ã" },
            { name: "–ü–ª–∏—Ç–∫–∞", order: 5, color: "#3182ce", category: "–û—Ç–¥–µ–ª–æ—á–Ω—ã–µ —Ä–∞–±–æ—Ç—ã" },
            { name: "–°–∞–ø–æ–∂–æ–∫", order: 6, color: "#805ad5", category: "–û—Ç–¥–µ–ª–æ—á–Ω—ã–µ —Ä–∞–±–æ—Ç—ã" },
            { name: "–ì–ö–õ", order: 7, color: "#9c88ff", category: "–ö–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏" },
            { name: "–ê—Ä–º—Å—Ç—Ä–æ–Ω–≥", order: 8, color: "#48bb78", category: "–ü–æ—Ç–æ–ª–∫–∏" },
            { name: "–ì—Ä–∏–ª—å—è—Ç–æ", order: 9, color: "#ed8936", category: "–ü–æ—Ç–æ–ª–∫–∏" },
            { name: "–ö–≤–∞—Ä—Ü –≤–∏–Ω–∏–ª", order: 10, color: "#38b2ac", category: "–ù–∞–ø–æ–ª—å–Ω—ã–µ –ø–æ–∫—Ä—ã—Ç–∏—è" },
            { name: "–®–∫—É—Ä–∫–∞", order: 11, color: "#667eea", category: "–û—Ç–¥–µ–ª–æ—á–Ω—ã–µ —Ä–∞–±–æ—Ç—ã" },
            { name: "–ü–æ–∫—Ä–∞—Å–∫–∞", order: 12, color: "#e53e3e", category: "–û—Ç–¥–µ–ª–æ—á–Ω—ã–µ —Ä–∞–±–æ—Ç—ã" },
            { name: "–ü–æ–∫—Ä–∞—Å–∫–∞ —Å—Ç–µ–Ω", order: 13, color: "#718096", category: "–û—Ç–¥–µ–ª–æ—á–Ω—ã–µ —Ä–∞–±–æ—Ç—ã" },
            { name: "–°–∞–ø–æ–∂–æ–∫ (–ø–æ—Å–ª–µ –¥–≤–µ—Ä–Ω–∏–∫–æ–≤)", order: 14, color: "#4a5568", category: "–û—Ç–¥–µ–ª–æ—á–Ω—ã–µ —Ä–∞–±–æ—Ç—ã" },
            { name: "–ó–∞–¥–µ–ª–∫–∞ —à—Ç—Ä–æ–± –ø–æ–¥ —Ä–∞–¥–∏–∞—Ç–æ—Ä–æ–º", order: 15, color: "#2d3748", category: "–°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —Ä–∞–±–æ—Ç—ã" },
            { name: "–î–≤–µ—Ä–Ω—ã–µ –æ—Ç–∫–æ—Å—ã –≤–Ω—É—Ç—Ä–∏ –∫–≤–∞—Ä—Ç–∏—Ä—ã", order: 16, color: "#1a202c", category: "–°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —Ä–∞–±–æ—Ç—ã" },
            { name: "–ú–æ–Ω—Ç–∞–∂ –ø–ª–∏—Ç–∫–∏ –Ω–∞ –ø–æ–¥–æ–∫–æ–Ω–Ω–∏–∫–∏", order: 17, color: "#e53e3e", category: "–°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —Ä–∞–±–æ—Ç—ã" },
            { name: "–ú–æ–Ω—Ç–∞–∂ –ø–ª–∏—Ç–∫–∏ –Ω–∞ –ª–∏—Ñ—Ç–æ–≤—ã–µ –ø–æ—Ä—Ç–∞–ª—ã", order: 18, color: "#718096", category: "–°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —Ä–∞–±–æ—Ç—ã" },
            { name: "–ú–æ–Ω—Ç–∞–∂ —Ç–∞–±–ª–∏—á–µ–∫", order: 19, color: "#fd7900", category: "–ó–∞–≤–µ—Ä—à–∞—é—â–∏–µ —Ä–∞–±–æ—Ç—ã" },
            { name: "–£–±–æ—Ä–∫–∞", order: 20, color: "#38a169", category: "–ó–∞–≤–µ—Ä—à–∞—é—â–∏–µ —Ä–∞–±–æ—Ç—ã" }
        ];

        const objectsDatabase = [
            "–í–ù–°", "–ö–≤–∞—Ä—Ç–∏—Ä—ã", "–ö–æ–º–º–µ—Ä—Ü–∏—è", "–õ–µ—Å—Ç. –º.", "–õ–∏—Ñ—Ç.—Ö–æ–ª–ª", "–ú–û–ü", "–≠–ª–µ–∫—Ç—Ä–æ—â–∏—Ç–æ–≤–∞—è"
        ];

        const executorsDatabase = [
            "–°–ú–† –ú–∞–π–∫–æ–ø", "–°–ú–† –ì—É–ª—å–∫–µ–≤–∏—á–∏", "–°–ú–† –ö—Ä–æ–ø–æ—Ç–∫–∏–Ω", "–ë—Ä–∏–≥–∞–¥–∞ ‚Ññ1", "–ë—Ä–∏–≥–∞–¥–∞ ‚Ññ2", 
            "–≠–ª–µ–∫—Ç—Ä–∏–∫–∏", "–°–∞–Ω—Ç–µ—Ö–Ω–∏–∫–∏", "–û—Ç–¥–µ–ª–æ—á–Ω–∏–∫–∏", "–£–Ω–∏–≤–µ—Ä—Å–∞–ª—ã", "–ü–æ–¥—Ä—è–¥—á–∏–∫ –ê", "–ü–æ–¥—Ä—è–¥—á–∏–∫ –ë"
        ];

        // === –î–ï–ú–û –ü–†–û–ï–ö–¢–´ ===
        let projectsStructure = {
            maikop: {
                code: "maikop",
                icon: "üèóÔ∏è",
                name: "–ñ–ö –ú–∞–π–∫–æ–ø –ª–∏—Ç–µ—Ä 3.2",
                description: "–°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π –∂–∏–ª–æ–π –∫–æ–º–ø–ª–µ–∫—Å —Å –∫–æ–º–º–µ—Ä—á–µ—Å–∫–∏–º–∏ –ø–æ–º–µ—â–µ–Ω–∏—è–º–∏",
                client: "–ì—Ä—É–ø–ø–∞ –∫–æ–º–ø–∞–Ω–∏–π –°—Ç—Ä–æ–π–∞–ª—å—è–Ω—Å",
                contractor: "–°–ú–† –ú–∞–π–∫–æ–ø",
                address: "–≥. –ú–∞–π–∫–æ–ø, –ø—Ä. –õ–µ–Ω–∏–Ω–∞, 234",
                startDate: "2024-05-31",
                endDate: "2024-08-10",
                budget: 1200000000,
                blocks: {
                    "–ú-1": { floors: ["1", "2", "3", "4", "5", "6", "7", "8", "9"] },
                    "–ú-2": { floors: ["1", "2", "3", "4", "5", "6", "7", "8", "9"] }
                },
                objects: ["–ö–æ–º–º–µ—Ä—Ü–∏—è", "–õ–∏—Ñ—Ç.—Ö–æ–ª–ª", "–ö–≤–∞—Ä—Ç–∏—Ä—ã", "–ú–û–ü", "–ª–µ—Å—Ç. –º."]
            },
            gulkevichi: {
                code: "gulkevichi", 
                icon: "üè¢",
                name: "–ñ–ö –ì—É–ª—å–∫–µ–≤–∏—á–∏",
                description: "–ñ–∏–ª–æ–π –∫–æ–º–ø–ª–µ–∫—Å –≤ –≥. –ì—É–ª—å–∫–µ–≤–∏—á–∏. 4 –±–ª–æ–∫–∞ —Å —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–º–∏ –ø–æ–º–µ—â–µ–Ω–∏—è–º–∏",
                client: "–û–û–û –°—Ç—Ä–æ–π-–ò–Ω–≤–µ—Å—Ç",
                contractor: "–°–ú–† –ì—É–ª—å–∫–µ–≤–∏—á–∏",
                address: "–≥. –ì—É–ª—å–∫–µ–≤–∏—á–∏, —É–ª. –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω–∞—è, 15",
                startDate: "2024-06-27",
                endDate: "2024-08-31", 
                budget: 850000000,
                blocks: {
                    "–ì-1": { floors: ["–¢–µ—Ö. –ü–æ–¥–ø–æ–ª—å–µ –ë–°4", "–¢–µ—Ö. –ü–æ–¥–ø–æ–ª—å–µ –ë–°2", "1", "2", "3", "4"] },
                    "–ì-2": { floors: ["1", "2", "3", "4"] },
                    "–ì-3": { floors: ["1", "2", "3", "4"] },
                    "–ì-4": { floors: ["1", "2", "3", "4"] }
                },
                objects: ["–≠–ª–µ–∫—Ç—Ä–æ—â–∏—Ç–æ–≤–∞—è", "–í–ù–°", "–ö–≤–∞—Ä—Ç–∏—Ä—ã", "–ú–û–ü", "–õ–∏—Ñ—Ç.—Ö–æ–ª–ª", "–õ–µ—Å—Ç. –º.", "–ö–æ–º–º–µ—Ä—Ü–∏—è"]
            },
            kropotkin: {
                code: "kropotkin",
                icon: "üè≠", 
                name: "–ö—Ä–æ–ø–æ—Ç–∫–∏–Ω –ø—Ä–æ–º—ã—à–ª–µ–Ω–Ω—ã–π –∫–æ–º–ø–ª–µ–∫—Å",
                description: "–ü—Ä–æ–º—ã—à–ª–µ–Ω–Ω—ã–π –æ–±—ä–µ–∫—Ç —Å –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ–Ω–Ω—ã–º–∏ –∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–º–∏ –ø–æ–º–µ—â–µ–Ω–∏—è–º–∏",
                client: "–ü–ê–û –ö—Ä–æ–ø–æ—Ç–∫–∏–Ω—Å–∫–∏–π –∑–∞–≤–æ–¥",
                contractor: "–°–ú–† –ö—Ä–æ–ø–æ—Ç–∫–∏–Ω",
                address: "–≥. –ö—Ä–æ–ø–æ—Ç–∫–∏–Ω, —É–ª. –ü—Ä–æ–º—ã—à–ª–µ–Ω–Ω–∞—è, 88",
                startDate: "2024-06-22",
                endDate: "2024-08-31",
                budget: 450000000,
                blocks: {
                    "–ö-2": { floors: ["–¢–µ—Ö. –ü–æ–¥–ø–æ–ª—å–µ", "1", "2", "3", "4", "5", "6", "7", "8", "9"] }
                },
                objects: ["–≠–ª–µ–∫—Ç—Ä–æ—â–∏—Ç–æ–≤–∞—è", "–í–ù–°", "–ö–≤–∞—Ä—Ç–∏—Ä—ã", "–ú–û–ü", "–õ–∏—Ñ—Ç.—Ö–æ–ª–ª", "–õ–µ—Å—Ç. –º."]
            }
        };

        // === –ì–õ–û–ë–ê–õ–¨–ù–´–ï –ü–ï–†–ï–ú–ï–ù–ù–´–ï ===
        let works = [];
        let activeProject = 'all';
        let selectedProject = null;
        let selectedBlock = null;
        let selectedFloor = null;
        let editingWorkId = null;
        let editingProjectId = null;
        let globalFilter = 'all';
        let categoryFilter = 'all';
        let currentSort = 'default';

        // === –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø ===
        document.addEventListener('DOMContentLoaded', function() {
            generateDemoWorks();
            updateProjectSelect();
            renderProjectTree();
            updateDashboard();
            setupEventListeners();
            applyGlobalFilter();
        });

        // === –ì–ï–ù–ï–†–ê–¶–ò–Ø –î–ï–ú–û –†–ê–ë–û–¢ ===
        function generateDemoWorks() {
            works = [];
            let workId = 1;

            Object.keys(projectsStructure).forEach(projectKey => {
                const project = projectsStructure[projectKey];
                
                Object.keys(project.blocks).forEach(blockKey => {
                    const floors = project.blocks[blockKey].floors;
                    
                    floors.forEach(floor => {
                        project.objects.forEach(object => {
                            // –°–æ–∑–¥–∞–µ–º —Ä–∞–±–æ—Ç—ã –≤—ã–±–æ—Ä–æ—á–Ω–æ –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏
                            workTypesDatabase.forEach((workType, index) => {
                                if (Math.random() > 0.6) { // 40% –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å —Å–æ–∑–¥–∞–Ω–∏—è —Ä–∞–±–æ—Ç—ã
                                    const startDate = new Date();
                                    startDate.setDate(startDate.getDate() + Math.random() * 60 - 30);
                                    
                                    const endDate = new Date(startDate);
                                    endDate.setDate(endDate.getDate() + Math.random() * 14 + 3);
                                    
                                    const progress = Math.floor(Math.random() * 101);
                                    let status = getRandomStatus();
                                    
                                    if (progress === 0) status = 'not-started';
                                    else if (progress === 100) status = 'completed';
                                    else if (endDate < new Date()) status = 'overdue';
                                    else status = 'in-progress';

                                    works.push({
                                        id: workId++,
                                        project: projectKey,
                                        block: blockKey,
                                        floor: floor,
                                        object: object,
                                        workType: workType.name,
                                        executor: executorsDatabase[Math.floor(Math.random() * executorsDatabase.length)],
                                        startDate: startDate.toISOString().split('T')[0],
                                        endDate: endDate.toISOString().split('T')[0],
                                        progress: progress,
                                        status: status,
                                        priority: getRandomPriority(),
                                        notes: '',
                                        techOrder: workType.order,
                                        category: workType.category,
                                        stage: Math.floor(Math.random() * 5) + 1
                                    });
                                }
                            });
                        });
                    });
                });
            });

            console.log('–°–æ–∑–¥–∞–Ω–æ ' + works.length + ' –¥–µ–º–æ —Ä–∞–±–æ—Ç –¥–ª—è –≤—Å–µ—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤');
        }

        function getRandomStatus() {
            const statuses = ['not-started', 'in-progress', 'completed', 'overdue'];
            return statuses[Math.floor(Math.random() * statuses.length)];
        }

        function getRandomPriority() {
            const priorities = ['low', 'medium', 'high'];
            return priorities[Math.floor(Math.random() * priorities.length)];
        }

        // === –ù–ê–°–¢–†–û–ô–ö–ê –û–ë–†–ê–ë–û–¢–ß–ò–ö–û–í –°–û–ë–´–¢–ò–ô ===
        function setupEventListeners() {
            document.getElementById('globalSearchInput').addEventListener('input', debounce(applyGlobalFilter, 300));
            
            document.getElementById('editProgress').addEventListener('input', function(e) {
                document.getElementById('progressValue').textContent = e.target.value;
            });

            document.getElementById('workForm').addEventListener('submit', function(e) {
                e.preventDefault();
                saveWork();
            });

            document.getElementById('projectForm').addEventListener('submit', function(e) {
                e.preventDefault();
                saveProject();
            });

            window.addEventListener('click', function(event) {
                if (event.target.classList.contains('modal')) {
                    event.target.classList.remove('active');
                }
            });

            document.addEventListener('keydown', function(event) {
                if (event.key === 'Escape') {
                    document.querySelectorAll('.modal.active').forEach(modal => {
                        modal.classList.remove('active');
                    });
                }
            });
        }

        function debounce(func, wait) {
            let timeout;
            return function executedFunction(...args) {
                const later = () => {
                    clearTimeout(timeout);
                    func(...args);
                };
                clearTimeout(timeout);
                timeout = setTimeout(later, wait);
            };
        }

        // === –§–ò–õ–¨–¢–†–ê–¶–ò–Ø –ò –ü–û–ò–°–ö ===
        function setGlobalFilter(filterType) {
            document.querySelectorAll('.filter-btn').forEach(btn => btn.classList.remove('active'));
            
            globalFilter = filterType;
            
            const activeBtn = document.getElementById({
                'all': 'allWorksFilter',
                'completed': 'completedFilter',
                'not-completed': 'notCompletedFilter',
                'today': 'todayFilter',
                'overdue': 'overdueFilter'
            }[filterType]);
            
            if (activeBtn) {
                activeBtn.classList.add('active');
            }
            
            applyGlobalFilter();
        }

        function setCategoryFilter(category) {
            document.querySelectorAll('.category-filter').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            categoryFilter = category;
            applyGlobalFilter();
        }

        function applyGlobalFilter() {
            const searchTerm = document.getElementById('globalSearchInput').value.toLowerCase();
            let filteredWorks = [...works];

            // –§–∏–ª—å—Ç—Ä –ø–æ –∞–∫—Ç–∏–≤–Ω–æ–º—É –ø—Ä–æ–µ–∫—Ç—É
            if (activeProject !== 'all') {
                filteredWorks = filteredWorks.filter(w => w.project === activeProject);
            }

            // –ü—Ä–∏–º–µ–Ω—è–µ–º –≥–ª–æ–±–∞–ª—å–Ω—ã–µ —Ñ–∏–ª—å—Ç—Ä—ã
            switch (globalFilter) {
                case 'completed':
                    filteredWorks = filteredWorks.filter(w => w.status === 'completed');
                    break;
                case 'not-completed':
                    filteredWorks = filteredWorks.filter(w => w.status !== 'completed');
                    break;
                case 'today':
                    const today = new Date().toISOString().split('T')[0];
                    filteredWorks = filteredWorks.filter(w => 
                        w.startDate <= today && w.endDate >= today
                    );
                    break;
                case 'overdue':
                    filteredWorks = filteredWorks.filter(w => w.status === 'overdue');
                    break;
            }

            // –§–∏–ª—å—Ç—Ä –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º
            if (categoryFilter !== 'all') {
                filteredWorks = filteredWorks.filter(w => w.category === categoryFilter);
            }

            // –ü—Ä–∏–º–µ–Ω—è–µ–º —Ç–µ–∫—Å—Ç–æ–≤—ã–π –ø–æ–∏—Å–∫
            if (searchTerm) {
                filteredWorks = filteredWorks.filter(w => 
                    w.workType.toLowerCase().includes(searchTerm) ||
                    w.object.toLowerCase().includes(searchTerm) ||
                    w.executor.toLowerCase().includes(searchTerm) ||
                    w.block.toLowerCase().includes(searchTerm) ||
                    w.floor.toLowerCase().includes(searchTerm) ||
                    (w.notes && w.notes.toLowerCase().includes(searchTerm)) ||
                    (projectsStructure[w.project] && projectsStructure[w.project].name.toLowerCase().includes(searchTerm))
                );
            }

            // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –≤—ã–±—Ä–∞–Ω–Ω—ã–º —ç–ª–µ–º–µ–Ω—Ç–∞–º
            if (selectedProject && selectedBlock && selectedFloor) {
                filteredWorks = filteredWorks.filter(w => 
                    w.project === selectedProject && 
                    w.block === selectedBlock && 
                    w.floor === selectedFloor
                );
            } else if (selectedProject && selectedBlock) {
                filteredWorks = filteredWorks.filter(w => 
                    w.project === selectedProject && 
                    w.block === selectedBlock
                );
            } else if (selectedProject) {
                filteredWorks = filteredWorks.filter(w => w.project === selectedProject);
            }

            renderWorks(filteredWorks);
            updateContentTitle(filteredWorks.length);
            updateVisibleWorksCount(filteredWorks.length);
        }

        // –ü—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ —Å–ª–µ–¥—É–µ—Ç...
        // === –£–ü–†–ê–í–õ–ï–ù–ò–ï –ü–†–û–ï–ö–¢–ê–ú–ò ===
        function changeActiveProject() {
            activeProject = document.getElementById('activeProjectSelect').value;
            
            selectedProject = null;
            selectedBlock = null;
            selectedFloor = null;
            
            updateDashboard();
            updateProjectMeta();
            renderProjectTree();
            applyGlobalFilter();
        }

        function updateProjectMeta() {
            const metaElement = document.getElementById('projectMeta');
            
            if (activeProject === 'all') {
                const totalProjects = Object.keys(projectsStructure).length;
                const totalWorks = works.length;
                metaElement.textContent = totalProjects + ' –ø—Ä–æ–µ–∫—Ç–æ–≤, ' + totalWorks + ' —Ä–∞–±–æ—Ç';
            } else {
                const project = projectsStructure[activeProject];
                const projectWorks = works.filter(w => w.project === activeProject);
                if (project) {
                    metaElement.textContent = Object.keys(project.blocks).length + ' –±–ª–æ–∫–æ–≤, ' + projectWorks.length + ' —Ä–∞–±–æ—Ç';
                }
            }
        }

        function updateProjectSelect() {
            const select = document.getElementById('activeProjectSelect');
            select.innerHTML = '<option value="all">üåê –í—Å–µ –ø—Ä–æ–µ–∫—Ç—ã</option>' +
                Object.keys(projectsStructure).map(projectKey => {
                    const project = projectsStructure[projectKey];
                    return '<option value="' + projectKey + '">' + project.icon + ' ' + project.name + '</option>';
                }).join('');
        }

        // === –†–ï–ù–î–ï–†–ò–ù–ì –î–ï–†–ï–í–ê –ü–†–û–ï–ö–¢–û–í ===
        function renderProjectTree() {
            const container = document.getElementById('projectTree');
            
            if (activeProject === 'all') {
                container.innerHTML = Object.keys(projectsStructure).map(projectKey => {
                    const project = projectsStructure[projectKey];
                    const projectWorks = works.filter(w => w.project === projectKey);
                    
                    return '<div class="tree-project ' + (selectedProject === projectKey ? 'active' : '') + '" id="tree-project-' + projectKey + '">' +
                        '<div class="tree-project-header" onclick="toggleProject(\'' + projectKey + '\')">' +
                            '<div class="tree-project-name">' +
                                project.icon + ' ' + project.name +
                            '</div>' +
                            '<span>(' + projectWorks.length + ' —Ä–∞–±–æ—Ç)</span>' +
                        '</div>' +
                        '<div class="tree-blocks">' +
                            Object.keys(project.blocks).map(blockKey => {
                                const blockWorks = projectWorks.filter(w => w.block === blockKey);
                                return '<div class="tree-block ' + (selectedBlock === blockKey ? 'active' : '') + '" id="tree-block-' + blockKey + '">' +
                                    '<div class="tree-block-header" onclick="toggleBlock(\'' + projectKey + '\', \'' + blockKey + '\')">' +
                                        '<span>üè¢ ' + blockKey + '</span>' +
                                        '<span>(' + blockWorks.length + ')</span>' +
                                    '</div>' +
                                    '<div class="tree-floors">' +
                                        project.blocks[blockKey].floors.map(floor => {
                                            const floorWorks = blockWorks.filter(w => w.floor === floor);
                                            return '<div class="tree-floor ' + (selectedFloor === floor ? 'selected' : '') + '" onclick="selectFloor(\'' + projectKey + '\', \'' + blockKey + '\', \'' + floor + '\')">' +
                                                '<span>üìã ' + floor + '</span>' +
                                                '<span>(' + floorWorks.length + ')</span>' +
                                            '</div>';
                                        }).join('') +
                                    '</div>' +
                                '</div>';
                            }).join('') +
                        '</div>' +
                    '</div>';
                }).join('');
            } else {
                const project = projectsStructure[activeProject];
                const projectWorks = works.filter(w => w.project === activeProject);
                
                container.innerHTML = '<div class="tree-project active" id="tree-project-' + activeProject + '">' +
                    '<div class="tree-project-header">' +
                        '<div class="tree-project-name">' +
                            project.icon + ' ' + project.name +
                        '</div>' +
                        '<span>(' + projectWorks.length + ' —Ä–∞–±–æ—Ç)</span>' +
                    '</div>' +
                    '<div class="tree-blocks">' +
                        Object.keys(project.blocks).map(blockKey => {
                            const blockWorks = projectWorks.filter(w => w.block === blockKey);
                            return '<div class="tree-block ' + (selectedBlock === blockKey ? 'active' : '') + '" id="tree-block-' + blockKey + '">' +
                                '<div class="tree-block-header" onclick="toggleBlock(\'' + activeProject + '\', \'' + blockKey + '\')">' +
                                    '<span>üè¢ ' + blockKey + '</span>' +
                                    '<span>(' + blockWorks.length + ')</span>' +
                                '</div>' +
                                '<div class="tree-floors">' +
                                    project.blocks[blockKey].floors.map(floor => {
                                        const floorWorks = blockWorks.filter(w => w.floor === floor);
                                        return '<div class="tree-floor ' + (selectedFloor === floor ? 'selected' : '') + '" onclick="selectFloor(\'' + activeProject + '\', \'' + blockKey + '\', \'' + floor + '\')">' +
                                            '<span>üìã ' + floor + '</span>' +
                                            '<span>(' + floorWorks.length + ')</span>' +
                                        '</div>';
                                    }).join('') +
                                '</div>' +
                            '</div>';
                        }).join('') +
                    '</div>' +
                '</div>';
            }
        }

        function toggleProject(projectKey) {
            selectedProject = selectedProject === projectKey ? null : projectKey;
            selectedBlock = null;
            selectedFloor = null;
            renderProjectTree();
            applyGlobalFilter();
        }

        function toggleBlock(projectKey, blockKey) {
            selectedProject = projectKey;
            selectedBlock = selectedBlock === blockKey ? null : blockKey;
            selectedFloor = null;
            renderProjectTree();
            applyGlobalFilter();
        }

        function selectFloor(projectKey, blockKey, floor) {
            selectedProject = projectKey;
            selectedBlock = blockKey;
            selectedFloor = floor;
            renderProjectTree();
            applyGlobalFilter();
        }

        // === –†–ï–ù–î–ï–†–ò–ù–ì –†–ê–ë–û–¢ ===
        function renderWorks(worksToRender) {
            const container = document.getElementById('worksContainer');
            
            if (worksToRender.length === 0) {
                const emptyMessage = getEmptyStateMessage();
                container.innerHTML = '<div class="empty-state">' +
                    '<div class="empty-state-icon">' + emptyMessage.icon + '</div>' +
                    '<h3>' + emptyMessage.title + '</h3>' +
                    '<p>' + emptyMessage.description + '</p>' +
                    '<button class="btn btn-success" onclick="addNewWork()">‚ûï –î–æ–±–∞–≤–∏—Ç—å —Ä–∞–±–æ—Ç—É</button>' +
                '</div>';
                return;
            }

            const sortedWorks = applySortingToWorks(worksToRender);

            container.innerHTML = '<div class="works-grid">' +
                sortedWorks.map(work => {
                    const techOrderClass = 'tech-order-' + Math.min(work.techOrder, 20);
                    const workTypeInfo = workTypesDatabase.find(wt => wt.name === work.workType);
                    const techOrderColor = workTypeInfo ? workTypeInfo.color : '#dee2e6';
                    
                    return '<div class="work-card ' + techOrderClass + '">' +
                        '<div class="work-header">' +
                            '<div class="work-title">' +
                                work.workType +
                                '<span class="tech-order-badge" style="background: ' + techOrderColor + '">' +
                                    '#' + work.techOrder +
                                '</span>' +
                                '<span class="category-badge" style="background: ' + getCategoryColor(work.category) + '">' +
                                    work.category.split(' ')[0] +
                                '</span>' +
                            '</div>' +
                            '<div class="work-actions">' +
                                '<button class="btn btn-primary btn-small" onclick="editWork(' + work.id + ')" title="–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å">‚úèÔ∏è</button>' +
                                '<button class="btn btn-danger btn-small" onclick="deleteWork(' + work.id + ')" title="–£–¥–∞–ª–∏—Ç—å">üóëÔ∏è</button>' +
                            '</div>' +
                        '</div>' +
                        
                        '<div class="work-details">' +
                            '<div class="work-detail">' +
                                '<span class="work-detail-label">–ü—Ä–æ–µ–∫—Ç:</span>' +
                                '<span class="work-detail-value">' + (projectsStructure[work.project] ? projectsStructure[work.project].icon + ' ' + projectsStructure[work.project].name : '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π –ø—Ä–æ–µ–∫—Ç') + '</span>' +
                            '</div>' +
                            '<div class="work-detail">' +
                                '<span class="work-detail-label">–ë–ª–æ–∫/–≠—Ç–∞–∂:</span>' +
                                '<span class="work-detail-value">' + work.block + ' - ' + work.floor + '</span>' +
                            '</div>' +
                            '<div class="work-detail">' +
                                '<span class="work-detail-label">–û–±—ä–µ–∫—Ç:</span>' +
                                '<span class="work-detail-value">' + work.object + '</span>' +
                            '</div>' +
                            '<div class="work-detail">' +
                                '<span class="work-detail-label">–ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å:</span>' +
                                '<span class="work-detail-value">' + work.executor + '</span>' +
                            '</div>' +
                            '<div class="work-detail">' +
                                '<span class="work-detail-label">–ü–µ—Ä–∏–æ–¥:</span>' +
                                '<span class="work-detail-value">' + formatDate(work.startDate) + ' - ' + formatDate(work.endDate) + '</span>' +
                            '</div>' +
                            '<div class="work-detail">' +
                                '<span class="work-detail-label">–°—Ç–∞—Ç—É—Å:</span>' +
                                '<span class="work-detail-value">' + getStatusText(work.status) + '</span>' +
                            '</div>' +
                        '</div>' +
                        
                        '<div class="progress-section">' +
                            '<div class="progress-bar" onclick="quickEditProgress(' + work.id + ')">' +
                                '<div class="progress-fill" style="width: ' + work.progress + '%"></div>' +
                                '<div class="progress-text">' + work.progress + '% –≤—ã–ø–æ–ª–Ω–µ–Ω–æ</div>' +
                            '</div>' +
                        '</div>' +

                        '<div class="status-controls">' +
                            '<button class="status-btn status-not-started' + (work.status === 'not-started' ? ' active' : '') + '" onclick="changeWorkStatus(' + work.id + ', \'not-started\')">–ù–µ –Ω–∞—á–∞—Ç–æ</button>' +
                            '<button class="status-btn status-in-progress' + (work.status === 'in-progress' ? ' active' : '') + '" onclick="changeWorkStatus(' + work.id + ', \'in-progress\')">–í –ø—Ä–æ—Ü–µ—Å—Å–µ</button>' +
                            '<button class="status-btn status-completed' + (work.status === 'completed' ? ' active' : '') + '" onclick="changeWorkStatus(' + work.id + ', \'completed\')">–ó–∞–≤–µ—Ä—à–µ–Ω–æ</button>' +
                            '<button class="status-btn status-overdue' + (work.status === 'overdue' ? ' active' : '') + '" onclick="changeWorkStatus(' + work.id + ', \'overdue\')">–ü—Ä–æ—Å—Ä–æ—á–µ–Ω–æ</button>' +
                        '</div>' +
                    '</div>';
                }).join('') +
            '</div>';
        }

        function getCategoryColor(category) {
            const colors = {
                '–ß–µ—Ä–Ω–æ–≤—ã–µ —Ä–∞–±–æ—Ç—ã': '#e53e3e',
                '–û—Ç–¥–µ–ª–æ—á–Ω—ã–µ —Ä–∞–±–æ—Ç—ã': '#38a169',
                '–ü–æ—Ç–æ–ª–∫–∏': '#3182ce',
                '–ö–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏': '#805ad5',
                '–ù–∞–ø–æ–ª—å–Ω—ã–µ –ø–æ–∫—Ä—ã—Ç–∏—è': '#ed8936',
                '–°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —Ä–∞–±–æ—Ç—ã': '#fd7900',
                '–ó–∞–≤–µ—Ä—à–∞—é—â–∏–µ —Ä–∞–±–æ—Ç—ã': '#28a745'
            };
            return colors[category] || '#6c757d';
        }

        // === –£–ü–†–ê–í–õ–ï–ù–ò–ï –°–¢–ê–¢–£–°–ê–ú–ò –ò –≠–¢–ê–ü–ê–ú–ò ===
        function changeWorkStatus(workId, newStatus) {
            const work = works.find(w => w.id === workId);
            if (work) {
                work.status = newStatus;
                
                switch (newStatus) {
                    case 'not-started':
                        work.progress = 0;
                        break;
                    case 'in-progress':
                        work.progress = work.progress || 25;
                        break;
                    case 'completed':
                        work.progress = 100;
                        break;
                    case 'overdue':
                        break;
                }
                
                applyGlobalFilter();
                renderProjectTree();
                updateDashboard();
            }
        }

        function quickEditProgress(workId) {
            const newProgress = prompt('–í–≤–µ–¥–∏—Ç–µ –ø—Ä–æ—Ü–µ–Ω—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è (0-100):');
            if (newProgress !== null && !isNaN(newProgress) && newProgress >= 0 && newProgress <= 100) {
                const work = works.find(w => w.id === workId);
                if (work) {
                    work.progress = parseInt(newProgress);
                    
                    if (work.progress === 0) work.status = 'not-started';
                    else if (work.progress === 100) work.status = 'completed';
                    else work.status = 'in-progress';
                    
                    applyGlobalFilter();
                    renderProjectTree();
                    updateDashboard();
                    showNotification('–ü—Ä–æ–≥—Ä–µ—Å—Å –æ–±–Ω–æ–≤–ª–µ–Ω', 'success');
                }
            }
        }

        // === –°–û–†–¢–ò–†–û–í–ö–ê ===
        function applySortingToWorks(worksArray) {
            const sortBy = document.getElementById('sortBySelect').value;
            
            return [...worksArray].sort((a, b) => {
                switch (sortBy) {
                    case 'technology':
                        return a.techOrder - b.techOrder;
                    case 'progress':
                        return b.progress - a.progress;
                    case 'date':
                        return new Date(a.startDate) - new Date(b.startDate);
                    case 'status':
                        const statusOrder = { 'overdue': 0, 'in-progress': 1, 'not-started': 2, 'completed': 3 };
                        return statusOrder[a.status] - statusOrder[b.status];
                    case 'floor':
                        return a.floor.localeCompare(b.floor);
                    case 'category':
                        return a.category.localeCompare(b.category);
                    default:
                        return a.id - b.id;
                }
            });
        }

        function applySorting() {
            applyGlobalFilter();
        }

        // === –†–ê–ë–û–¢–ê –° –†–ê–ë–û–¢–ê–ú–ò ===
        function addNewWork() {
            editingWorkId = null;
            updateAllSelects();
            
            const defaultProject = activeProject !== 'all' ? activeProject : Object.keys(projectsStructure)[0];
            document.getElementById('editProject').value = defaultProject;
            updateProjectFields();
            
            document.getElementById('editExecutor').value = executorsDatabase[0];
            document.getElementById('editPriority').value = 'medium';
            
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('editStartDate').value = today;
            document.getElementById('editEndDate').value = today;
            document.getElementById('editProgress').value = 0;
            document.getElementById('editStatus').value = 'not-started';
            document.getElementById('progressValue').textContent = '0';
            document.getElementById('editNotes').value = '';
            
            document.getElementById('modalTitle').textContent = '–î–æ–±–∞–≤–∏—Ç—å —Ä–∞–±–æ—Ç—É';
            document.getElementById('editModal').classList.add('active');
        }

        function editWork(workId) {
            const work = works.find(w => w.id === workId);
            if (!work) return;

            editingWorkId = workId;
            updateAllSelects();
            
            document.getElementById('editProject').value = work.project;
            updateProjectFields();
            document.getElementById('editBlock').value = work.block;
            updateFloorOptions();
            document.getElementById('editFloor').value = work.floor;
            document.getElementById('editObject').value = work.object;
            document.getElementById('editCategory').value = work.category || '';
            updateWorkTypeOptions();
            document.getElementById('editWorkType').value = work.workType;
            document.getElementById('editExecutor').value = work.executor;
            document.getElementById('editStartDate').value = work.startDate;
            document.getElementById('editEndDate').value = work.endDate;
            document.getElementById('editProgress').value = work.progress;
            document.getElementById('editStatus').value = work.status;
            document.getElementById('editPriority').value = work.priority || 'medium';
            document.getElementById('progressValue').textContent = work.progress;
            document.getElementById('editNotes').value = work.notes || '';
            
            document.getElementById('modalTitle').textContent = '–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Ä–∞–±–æ—Ç—É';
            document.getElementById('editModal').classList.add('active');
        }

        function deleteWork(workId) {
            if (confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç—É —Ä–∞–±–æ—Ç—É?')) {
                works = works.filter(w => w.id !== workId);
                
                applyGlobalFilter();
                renderProjectTree();
                updateDashboard();
                showNotification('–†–∞–±–æ—Ç–∞ —É–¥–∞–ª–µ–Ω–∞', 'success');
            }
        }

        function saveWork() {
            const workTypeName = document.getElementById('editWorkType').value;
            const workType = workTypesDatabase.find(wt => wt.name === workTypeName);
            
            const formData = {
                project: document.getElementById('editProject').value,
                block: document.getElementById('editBlock').value,
                floor: document.getElementById('editFloor').value,
                object: document.getElementById('editObject').value,
                workType: workTypeName,
                executor: document.getElementById('editExecutor').value,
                startDate: document.getElementById('editStartDate').value,
                endDate: document.getElementById('editEndDate').value,
                progress: parseInt(document.getElementById('editProgress').value),
                status: document.getElementById('editStatus').value,
                priority: document.getElementById('editPriority').value,
                notes: document.getElementById('editNotes').value,
                techOrder: workType ? workType.order : 1,
                category: workType ? workType.category : '–û—Ç–¥–µ–ª–æ—á–Ω—ã–µ —Ä–∞–±–æ—Ç—ã',
                stage: Math.floor(Math.random() * 5) + 1
            };
            
            if (!formData.project || !formData.block || !formData.floor || !formData.object || !formData.workType || !formData.executor || !formData.startDate || !formData.endDate) {
                showNotification('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è', 'error');
                return;
            }
            
            if (new Date(formData.startDate) > new Date(formData.endDate)) {
                showNotification('–î–∞—Ç–∞ –Ω–∞—á–∞–ª–∞ –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø–æ–∑–∂–µ –¥–∞—Ç—ã –æ–∫–æ–Ω—á–∞–Ω–∏—è', 'error');
                return;
            }
            
            if (editingWorkId) {
                const work = works.find(w => w.id === editingWorkId);
                if (work) {
                    Object.assign(work, formData);
                    showNotification('–†–∞–±–æ—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∞', 'success');
                }
            } else {
                const newWork = {
                    id: Math.max(...works.map(w => w.id), 0) + 1,
                    ...formData
                };
                works.push(newWork);
                showNotification('–†–∞–±–æ—Ç–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∞', 'success');
            }
            
            applyGlobalFilter();
            renderProjectTree();
            updateDashboard();
            closeModal('editModal');
        }

        // === –û–ë–ù–û–í–õ–ï–ù–ò–ï –°–ï–õ–ï–ö–¢–û–í ===
        function updateAllSelects() {
            updateProjectSelectInModal();
            updateCategorySelect();
            updateWorkTypeOptions();
        }

        function updateProjectSelectInModal() {
            const projectSelect = document.getElementById('editProject');
            projectSelect.innerHTML = Object.keys(projectsStructure).map(projectKey => 
                '<option value="' + projectKey + '">' + projectsStructure[projectKey].icon + ' ' + projectsStructure[projectKey].name + '</option>'
            ).join('');
        }

        function updateCategorySelect() {
            const categorySelect = document.getElementById('editCategory');
            const categories = [...new Set(workTypesDatabase.map(wt => wt.category))];
            categorySelect.innerHTML = '<option value="">–í—Å–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</option>' +
                categories.map(category => '<option value="' + category + '">' + category + '</option>').join('');
        }

        function updateProjectFields() {
            const projectKey = document.getElementById('editProject').value;
            const project = projectsStructure[projectKey];
            
            if (!project) return;
            
            const blockSelect = document.getElementById('editBlock');
            blockSelect.innerHTML = Object.keys(project.blocks).map(blockKey => 
                '<option value="' + blockKey + '">' + blockKey + '</option>'
            ).join('');
            
            const objectSelect = document.getElementById('editObject');
            objectSelect.innerHTML = project.objects.map(object => 
                '<option value="' + object + '">' + object + '</option>'
            ).join('');
            
            updateFloorOptions();
        }

        function updateFloorOptions() {
            const projectKey = document.getElementById('editProject').value;
            const blockKey = document.getElementById('editBlock').value;
            const floorSelect = document.getElementById('editFloor');
            
            if (projectKey && blockKey && projectsStructure[projectKey] && projectsStructure[projectKey].blocks[blockKey]) {
                const floors = projectsStructure[projectKey].blocks[blockKey].floors;
                floorSelect.innerHTML = floors.map(floor => 
                    '<option value="' + floor + '">' + floor + '</option>'
                ).join('');
            } else {
                floorSelect.innerHTML = '<option value="">–í—ã–±–µ—Ä–∏—Ç–µ –±–ª–æ–∫</option>';
            }
        }

        function updateWorkTypeOptions() {
            const categoryFilter = document.getElementById('editCategory').value;
            const workTypeSelect = document.getElementById('editWorkType');
            
            const filteredWorkTypes = categoryFilter 
                ? workTypesDatabase.filter(wt => wt.category === categoryFilter)
                : workTypesDatabase;
            
            workTypeSelect.innerHTML = filteredWorkTypes.map(workType => 
                '<option value="' + workType.name + '">' + workType.name + ' (#' + workType.order + ')</option>'
            ).join('');
        }

        // === –£–ü–†–ê–í–õ–ï–ù–ò–ï –ü–†–û–ï–ö–¢–ê–ú–ò ===
        function addNewProject() {
            editingProjectId = null;
            
            document.getElementById('projectCode').value = '';
            document.getElementById('projectIcon').value = 'üè¢';
            document.getElementById('projectName').value = '';
            document.getElementById('projectDescription').value = '';
            document.getElementById('projectClient').value = '';
            document.getElementById('projectContractor').value = '';
            document.getElementById('projectAddress').value = '';
            document.getElementById('projectStartDate').value = '';
            document.getElementById('projectEndDate').value = '';
            document.getElementById('projectBudget').value = '';
            document.getElementById('projectObjects').value = objectsDatabase.join(', ');
            
            // –û—á–∏—â–∞–µ–º –∏ –¥–æ–±–∞–≤–ª—è–µ–º –æ–¥–∏–Ω –±–ª–æ–∫ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
            document.getElementById('blocksContainer').innerHTML = '';
            addBlock();
            
            document.getElementById('projectModalTitle').textContent = '–°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π –ø—Ä–æ–µ–∫—Ç';
            document.getElementById('projectModal').classList.add('active');
        }

        function addBlock() {
            const container = document.getElementById('blocksContainer');
            const blockIndex = container.children.length + 1;
            
            const blockDiv = document.createElement('div');
            blockDiv.className = 'block-constructor';
            blockDiv.innerHTML = 
                '<div class="block-header">' +
                    '<input type="text" class="form-control block-name" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ –±–ª–æ–∫–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä: –ë–°-' + blockIndex + ')" value="–ë–°-' + blockIndex + '" style="flex: 1; margin-right: 10px;">' +
                    '<button type="button" class="btn btn-danger btn-small" onclick="removeBlock(this)">üóëÔ∏è</button>' +
                '</div>' +
                '<div class="floor-range">' +
                    '<label>–û—Ç —ç—Ç–∞–∂–∞:</label>' +
                    '<input type="text" class="form-control floor-from" placeholder="1" value="1">' +
                    '<label>–î–æ —ç—Ç–∞–∂–∞:</label>' +
                    '<input type="text" class="form-control floor-to" placeholder="9" value="9">' +
                    '<label>–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ:</label>' +
                    '<input type="text" class="form-control floor-extra" placeholder="–ü–æ–¥–≤–∞–ª, –¢–µ—Ö.—ç—Ç–∞–∂">' +
                '</div>';
            container.appendChild(blockDiv);
        }

        function removeBlock(button) {
            const blockInputs = document.querySelectorAll('.block-constructor');
            if (blockInputs.length > 1) {
                button.closest('.block-constructor').remove();
            } else {
                showNotification('–î–æ–ª–∂–µ–Ω –æ—Å—Ç–∞—Ç—å—Å—è —Ö–æ—Ç—è –±—ã –æ–¥–∏–Ω –±–ª–æ–∫', 'warning');
            }
        }

        function saveProject() {
            const formData = {
                code: document.getElementById('projectCode').value.trim(),
                icon: document.getElementById('projectIcon').value,
                name: document.getElementById('projectName').value.trim(),
                description: document.getElementById('projectDescription').value.trim(),
                client: document.getElementById('projectClient').value.trim(),
                contractor: document.getElementById('projectContractor').value.trim(),
                address: document.getElementById('projectAddress').value.trim(),
                startDate: document.getElementById('projectStartDate').value,
                endDate: document.getElementById('projectEndDate').value,
                budget: parseInt(document.getElementById('projectBudget').value) || 0
            };
            
            if (!formData.code || !formData.name) {
                showNotification('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è (–∫–æ–¥ –∏ –Ω–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞)', 'error');
                return;
            }
            
            if (!editingProjectId && projectsStructure[formData.code]) {
                showNotification('–ü—Ä–æ–µ–∫—Ç —Å —Ç–∞–∫–∏–º –∫–æ–¥–æ–º —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç', 'error');
                return;
            }
            
            // –°–æ–±–∏—Ä–∞–µ–º –±–ª–æ–∫–∏
            const blocks = {};
            const blockConstructors = document.querySelectorAll('.block-constructor');
            
            blockConstructors.forEach(blockDiv => {
                const blockName = blockDiv.querySelector('.block-name').value.trim();
                const floorFrom = blockDiv.querySelector('.floor-from').value.trim();
                const floorTo = blockDiv.querySelector('.floor-to').value.trim();
                const floorExtra = blockDiv.querySelector('.floor-extra').value.trim();
                
                if (blockName) {
                    const floors = [];
                    
                    // –î–æ–±–∞–≤–ª—è–µ–º –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —ç—Ç–∞–∂–∏
                    if (floorExtra) {
                        floorExtra.split(',').forEach(floor => {
                            const trimmed = floor.trim();
                            if (trimmed) floors.push(trimmed);
                        });
                    }
                    
                    // –î–æ–±–∞–≤–ª—è–µ–º –æ—Å–Ω–æ–≤–Ω—ã–µ —ç—Ç–∞–∂–∏
                    if (floorFrom && floorTo) {
                        const from = parseInt(floorFrom);
                        const to = parseInt(floorTo);
                        
                        if (!isNaN(from) && !isNaN(to) && from <= to) {
                            for (let i = from; i <= to; i++) {
                                floors.push(i.toString());
                            }
                        }
                    }
                    
                    blocks[blockName] = { floors: floors };
                }
            });
            
            const objectsText = document.getElementById('projectObjects').value.trim();
            const objects = objectsText.split(',').map(o => o.trim()).filter(o => o);
            
            const projectData = {
                code: formData.code,
                icon: formData.icon,
                name: formData.name,
                description: formData.description,
                client: formData.client,
                contractor: formData.contractor,
                address: formData.address,
                startDate: formData.startDate,
                endDate: formData.endDate,
                budget: formData.budget,
                blocks: blocks,
                objects: objects
            };
            
            if (editingProjectId) {
                const oldCode = editingProjectId;
                
                if (oldCode !== formData.code) {
                    works.forEach(work => {
                        if (work.project === oldCode) {
                            work.project = formData.code;
                        }
                    });
                    
                    delete projectsStructure[oldCode];
                    projectsStructure[formData.code] = projectData;
                    
                    if (activeProject === oldCode) {
                        activeProject = formData.code;
                        document.getElementById('activeProjectSelect').value = formData.code;
                    }
                } else {
                    projectsStructure[formData.code] = projectData;
                }
                
                showNotification('–ü—Ä–æ–µ–∫—Ç –æ–±–Ω–æ–≤–ª–µ–Ω', 'success');
            } else {
                projectsStructure[formData.code] = projectData;
                showNotification('–ü—Ä–æ–µ–∫—Ç —Å–æ–∑–¥–∞–Ω', 'success');
            }
            
            updateProjectSelect();
            renderProjectTree();
            updateDashboard();
            closeModal('projectModal');
        }

        function editProject(projectKey) {
            const project = projectsStructure[projectKey];
            if (!project) return;

            editingProjectId = projectKey;
            
            document.getElementById('projectCode').value = project.code;
            document.getElementById('projectIcon').value = project.icon;
            document.getElementById('projectName').value = project.name;
            document.getElementById('projectDescription').value = project.description || '';
            document.getElementById('projectClient').value = project.client || '';
            document.getElementById('projectContractor').value = project.contractor || '';
            document.getElementById('projectAddress').value = project.address || '';
            document.getElementById('projectStartDate').value = project.startDate || '';
            document.getElementById('projectEndDate').value = project.endDate || '';
            document.getElementById('projectBudget').value = project.budget || '';
            document.getElementById('projectObjects').value = project.objects.join(', ');
            
            // –ó–∞–≥—Ä—É–∂–∞–µ–º –±–ª–æ–∫–∏
            document.getElementById('blocksContainer').innerHTML = '';
            Object.keys(project.blocks).forEach(blockKey => {
                const blockDiv = document.createElement('div');
                blockDiv.className = 'block-constructor';
                
                const floors = project.blocks[blockKey].floors;
                const numericFloors = floors.filter(f => !isNaN(parseInt(f))).map(f => parseInt(f)).sort((a,b) => a-b);
                const extraFloors = floors.filter(f => isNaN(parseInt(f)));
                
                blockDiv.innerHTML = 
                    '<div class="block-header">' +
                        '<input type="text" class="form-control block-name" value="' + blockKey + '" style="flex: 1; margin-right: 10px;">' +
                        '<button type="button" class="btn btn-danger btn-small" onclick="removeBlock(this)">üóëÔ∏è</button>' +
                    '</div>' +
                    '<div class="floor-range">' +
                        '<label>–û—Ç —ç—Ç–∞–∂–∞:</label>' +
                        '<input type="text" class="form-control floor-from" value="' + (numericFloors.length > 0 ? numericFloors[0] : '1') + '">' +
                        '<label>–î–æ —ç—Ç–∞–∂–∞:</label>' +
                        '<input type="text" class="form-control floor-to" value="' + (numericFloors.length > 0 ? numericFloors[numericFloors.length - 1] : '9') + '">' +
                        '<label>–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ:</label>' +
                        '<input type="text" class="form-control floor-extra" value="' + extraFloors.join(', ') + '">' +
                    '</div>';
                document.getElementById('blocksContainer').appendChild(blockDiv);
            });
            
            document.getElementById('projectModalTitle').textContent = '–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–µ–∫—Ç';
            document.getElementById('projectModal').classList.add('active');
        }

        function deleteProject(projectKey) {
            const project = projectsStructure[projectKey];
            const projectWorks = works.filter(w => w.project === projectKey);
            
            let confirmMessage = '–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å –ø—Ä–æ–µ–∫—Ç "' + project.name + '"?';
            if (projectWorks.length > 0) {
                confirmMessage += '\n\n–í–ù–ò–ú–ê–ù–ò–ï: –í –ø—Ä–æ–µ–∫—Ç–µ –µ—Å—Ç—å ' + projectWorks.length + ' —Ä–∞–±–æ—Ç. –û–Ω–∏ —Ç–∞–∫–∂–µ –±—É–¥—É—Ç —É–¥–∞–ª–µ–Ω—ã!';
            }
            
            if (confirm(confirmMessage)) {
                works = works.filter(w => w.project !== projectKey);
                delete projectsStructure[projectKey];
                
                if (activeProject === projectKey) {
                    activeProject = 'all';
                    document.getElementById('activeProjectSelect').value = 'all';
                }
                
                updateProjectSelect();
                renderProjectTree();
                updateDashboard();
                applyGlobalFilter();
                
                showNotification('–ü—Ä–æ–µ–∫—Ç "' + project.name + '" —É–¥–∞–ª–µ–Ω', 'success');
            }
        }

        // === –°–¢–ê–¢–ò–°–¢–ò–ö–ê –ò –î–ê–®–ë–û–†–î ===
        function updateDashboard() {
            const filteredWorks = activeProject === 'all' 
                ? works 
                : works.filter(w => w.project === activeProject);
            
            const total = filteredWorks.length;
            const completed = filteredWorks.filter(w => w.status === 'completed').length;
            const inProgress = filteredWorks.filter(w => w.status === 'in-progress').length;
            const overdue = filteredWorks.filter(w => w.status === 'overdue').length;
            const avgProgress = total > 0 
                ? Math.round(filteredWorks.reduce((sum, w) => sum + w.progress, 0) / total)
                : 0;

            document.getElementById('totalWorks').textContent = total;
            document.getElementById('completedWorks').textContent = completed;
            document.getElementById('inProgressWorks').textContent = inProgress;
            document.getElementById('overdueWorks').textContent = overdue;
            document.getElementById('avgProgress').textContent = avgProgress + '%';

            const dashboardTitle = document.getElementById('dashboardTitle');
            const dashboardIcon = document.getElementById('dashboardIcon');
            
            if (activeProject === 'all') {
                dashboardTitle.textContent = '–û–±—â–∏–π –¥–∞—à–±–æ—Ä–¥ –≤—Å–µ—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤';
                dashboardIcon.textContent = 'üìä';
            } else {
                const project = projectsStructure[activeProject];
                dashboardTitle.textContent = '–î–∞—à–±–æ—Ä–¥ –ø—Ä–æ–µ–∫—Ç–∞ ' + project.icon + ' ' + project.name;
                dashboardIcon.textContent = project.icon;
            }

            updateProjectMeta();
        }

        function updateVisibleWorksCount(count) {
            document.getElementById('visibleWorks').textContent = count;
        }

        function updateContentTitle(visibleCount) {
            const titleElement = document.getElementById('contentTitle');
            
            if (selectedProject && selectedBlock && selectedFloor) {
                const projectName = projectsStructure[selectedProject].name;
                titleElement.innerHTML = 'üìã ' + projectName + ' - ' + selectedBlock + ' - ' + selectedFloor + ' (' + visibleCount + ' —Ä–∞–±–æ—Ç)';
            } else if (selectedProject && selectedBlock) {
                const projectName = projectsStructure[selectedProject].name;
                titleElement.innerHTML = 'üè¢ ' + projectName + ' - ' + selectedBlock + ' (' + visibleCount + ' —Ä–∞–±–æ—Ç)';
            } else if (selectedProject) {
                const projectName = projectsStructure[selectedProject].name;
                titleElement.innerHTML = 'üèóÔ∏è ' + projectName + ' (' + visibleCount + ' —Ä–∞–±–æ—Ç)';
            } else if (activeProject !== 'all') {
                const projectName = projectsStructure[activeProject].name;
                titleElement.innerHTML = 'üèóÔ∏è ' + projectName + ' (' + visibleCount + ' —Ä–∞–±–æ—Ç)';
            } else {
                titleElement.innerHTML = 'üåê –í—Å–µ –ø—Ä–æ–µ–∫—Ç—ã (' + visibleCount + ' —Ä–∞–±–æ—Ç)';
            }
        }

        // === –£–ü–†–ê–í–õ–ï–ù–ò–ï –ü–†–û–ï–ö–¢–ê–ú–ò ===
        function openProjectManager() {
            renderProjectsList();
            document.getElementById('projectManagerModal').classList.add('active');
        }

        function renderProjectsList() {
            const container = document.getElementById('projectsList');
            
            container.innerHTML = Object.keys(projectsStructure).map(projectKey => {
                const project = projectsStructure[projectKey];
                const projectWorks = works.filter(w => w.project === projectKey);
                const totalBlocks = Object.keys(project.blocks).length;
                const totalFloors = Object.values(project.blocks).reduce((sum, block) => sum + block.floors.length, 0);
                const completedWorks = projectWorks.filter(w => w.status === 'completed').length;
                const avgProgress = projectWorks.length > 0 
                    ? Math.round(projectWorks.reduce((sum, w) => sum + w.progress, 0) / projectWorks.length)
                    : 0;

                return '<div style="background: #f8f9fa; border: 1px solid #dee2e6; border-radius: 12px; padding: 20px; margin-bottom: 15px;">' +
                    '<div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">' +
                        '<div>' +
                            '<h3>' + project.icon + ' ' + project.name + '</h3>' +
                            '<p style="color: #6c757d; margin: 5px 0;">' + (project.description || '–û–ø–∏—Å–∞–Ω–∏–µ –Ω–µ —É–∫–∞–∑–∞–Ω–æ') + '</p>' +
                            '<small style="color: #6c757d;">' + (project.address || '–ê–¥—Ä–µ—Å –Ω–µ —É–∫–∞–∑–∞–Ω') + '</small>' +
                        '</div>' +
                        '<div style="display: flex; gap: 8px;">' +
                            '<button class="btn btn-primary btn-small" onclick="selectProjectFromManager(\'' + projectKey + '\')">üëÅÔ∏è –û—Ç–∫—Ä—ã—Ç—å</button>' +
                            '<button class="btn btn-warning btn-small" onclick="editProject(\'' + projectKey + '\')">‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</button>' +
                            '<button class="btn btn-danger btn-small" onclick="deleteProject(\'' + projectKey + '\')">üóëÔ∏è –£–¥–∞–ª–∏—Ç—å</button>' +
                        '</div>' +
                    '</div>' +
                    '<div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(120px, 1fr)); gap: 10px; text-align: center;">' +
                        '<div style="background: white; padding: 10px; border-radius: 6px;">' +
                            '<div style="font-size: 1.5em; font-weight: bold; color: #667eea;">' + totalBlocks + '</div>' +
                            '<div style="font-size: 11px; color: #6c757d;">–ë–ª–æ–∫–æ–≤</div>' +
                        '</div>' +
                        '<div style="background: white; padding: 10px; border-radius: 6px;">' +
                            '<div style="font-size: 1.5em; font-weight: bold; color: #667eea;">' + totalFloors + '</div>' +
                            '<div style="font-size: 11px; color: #6c757d;">–≠—Ç–∞–∂–µ–π</div>' +
                        '</div>' +
                        '<div style="background: white; padding: 10px; border-radius: 6px;">' +
                            '<div style="font-size: 1.5em; font-weight: bold; color: #667eea;">' + projectWorks.length + '</div>' +
                            '<div style="font-size: 11px; color: #6c757d;">–†–∞–±–æ—Ç</div>' +
                        '</div>' +
                        '<div style="background: white; padding: 10px; border-radius: 6px;">' +
                            '<div style="font-size: 1.5em; font-weight: bold; color: #667eea;">' + completedWorks + '</div>' +
                            '<div style="font-size: 11px; color: #6c757d;">–ó–∞–≤–µ—Ä—à–µ–Ω–æ</div>' +
                        '</div>' +
                        '<div style="background: white; padding: 10px; border-radius: 6px;">' +
                            '<div style="font-size: 1.5em; font-weight: bold; color: #667eea;">' + avgProgress + '%</div>' +
                            '<div style="font-size: 11px; color: #6c757d;">–ü—Ä–æ–≥—Ä–µ—Å—Å</div>' +
                        '</div>' +
                    '</div>' +
                '</div>';
            }).join('');
        }

        function selectProjectFromManager(projectKey) {
            document.getElementById('activeProjectSelect').value = projectKey;
            activeProject = projectKey;
            changeActiveProject();
            closeModal('projectManagerModal');
        }

        // === –≠–ö–°–ü–û–†–¢/–ò–ú–ü–û–†–¢ ===
        function exportData() {
            const exportFormat = prompt('–í—ã–±–µ—Ä–∏—Ç–µ —Ñ–æ—Ä–º–∞—Ç —ç–∫—Å–ø–æ—Ä—Ç–∞:\n1 - CSV (—Ç–æ–ª—å–∫–æ —Ä–∞–±–æ—Ç—ã)\n2 - JSON (–ø–æ–ª–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ)\n\n–í–≤–µ–¥–∏—Ç–µ 1 –∏–ª–∏ 2:');
            
            if (exportFormat === '1') {
                exportToCSV();
            } else if (exportFormat === '2') {
                exportToJSON();
            }
        }

        function exportToCSV() {
            const worksToExport = activeProject === 'all' ? works : works.filter(w => w.project === activeProject);
            
            if (worksToExport.length === 0) {
                showNotification('–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∞', 'warning');
                return;
            }
            
            const headers = [
                'ID', '–ü—Ä–æ–µ–∫—Ç', '–ë–ª–æ–∫', '–≠—Ç–∞–∂', '–û–±—ä–µ–∫—Ç', '–ö–∞—Ç–µ–≥–æ—Ä–∏—è —Ä–∞–±–æ—Ç', '–í–∏–¥ —Ä–∞–±–æ—Ç—ã', 
                '–ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å', '–î–∞—Ç–∞ –Ω–∞—á–∞–ª–∞', '–î–∞—Ç–∞ –æ–∫–æ–Ω—á–∞–Ω–∏—è', '–ü—Ä–æ–≥—Ä–µ—Å—Å %', '–°—Ç–∞—Ç—É—Å', 
                '–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç', '–¢–µ—Ö. –ø–æ—Ä—è–¥–æ–∫', '–ü—Ä–∏–º–µ—á–∞–Ω–∏—è'
            ];
            
            const csvData = [
                headers.join(','),
                ...worksToExport.map(w => [
                    w.id,
                    '"' + (projectsStructure[w.project] ? projectsStructure[w.project].name : '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π –ø—Ä–æ–µ–∫—Ç') + '"',
                    '"' + w.block + '"',
                    '"' + w.floor + '"',
                    '"' + w.object + '"',
                    '"' + (w.category || '') + '"',
                    '"' + w.workType + '"',
                    '"' + w.executor + '"',
                    w.startDate,
                    w.endDate,
                    w.progress,
                    '"' + getStatusText(w.status) + '"',
                    '"' + getPriorityText(w.priority) + '"',
                    w.techOrder,
                    '"' + (w.notes || '') + '"'
                ].join(','))
            ].join('\n');
            
            const blob = new Blob(['\ufeff' + csvData], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            
            const projectName = activeProject === 'all' ? 'all_projects' : activeProject;
            link.download = 'construction_works_' + projectName + '_' + new Date().toISOString().split('T')[0] + '.csv';
            link.click();
            
            showNotification('CSV —Ñ–∞–π–ª —Å–æ—Ö—Ä–∞–Ω–µ–Ω', 'success');
        }

        function exportToJSON() {
            const exportData = {
                projects: projectsStructure,
                works: works,
                exportDate: new Date().toISOString(),
                version: '2.0',
                workTypesDatabase: workTypesDatabase,
                objectsDatabase: objectsDatabase,
                executorsDatabase: executorsDatabase
            };
            
            const dataStr = JSON.stringify(exportData, null, 2);
            const blob = new Blob([dataStr], { type: 'application/json' });
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = 'construction_system_backup_' + new Date().toISOString().split('T')[0] + '.json';
            link.click();
            
            showNotification('–ü–æ–ª–Ω—ã–π —ç–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö —Å–æ—Ö—Ä–∞–Ω–µ–Ω', 'success');
        }

        function generateReport() {
            const reportData = {
                reportTitle: '–û—Ç—á–µ—Ç –ø–æ —Å—Ç—Ä–æ–∏—Ç–µ–ª—å–Ω—ã–º –ø—Ä–æ–µ–∫—Ç–∞–º',
                generated: new Date().toISOString(),
                period: {
                    from: new Date(Date.now() - 30 * 24 * 60 * 60 * 1000).toISOString().split('T')[0],
                    to: new Date().toISOString().split('T')[0]
                },
                summary: {
                    totalProjects: Object.keys(projectsStructure).length,
                    totalWorks: works.length,
                    completedWorks: works.filter(w => w.status === 'completed').length,
                    inProgressWorks: works.filter(w => w.status === 'in-progress').length,
                    overdueWorks: works.filter(w => w.status === 'overdue').length,
                    avgProgress: works.length > 0 
                        ? Math.round(works.reduce((sum, w) => sum + w.progress, 0) / works.length)
                        : 0
                },
                projectsAnalysis: {},
                categoriesAnalysis: {},
                executorsAnalysis: {}
            };

            // –ê–Ω–∞–ª–∏–∑ –ø–æ –ø—Ä–æ–µ–∫—Ç–∞–º
            Object.keys(projectsStructure).forEach(projectKey => {
                const project = projectsStructure[projectKey];
                const projectWorks = works.filter(w => w.project === projectKey);
                
                reportData.projectsAnalysis[project.name] = {
                    totalWorks: projectWorks.length,
                    completedWorks: projectWorks.filter(w => w.status === 'completed').length,
                    avgProgress: projectWorks.length > 0 
                        ? Math.round(projectWorks.reduce((sum, w) => sum + w.progress, 0) / projectWorks.length)
                        : 0,
                    blocksCount: Object.keys(project.blocks).length,
                    floorsCount: Object.values(project.blocks).reduce((sum, block) => sum + block.floors.length, 0)
                };
            });

            // –ê–Ω–∞–ª–∏–∑ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º
            const categories = [...new Set(workTypesDatabase.map(wt => wt.category))];
            categories.forEach(category => {
                const categoryWorks = works.filter(w => w.category === category);
                reportData.categoriesAnalysis[category] = {
                    totalWorks: categoryWorks.length,
                    completedWorks: categoryWorks.filter(w => w.status === 'completed').length,
                    avgProgress: categoryWorks.length > 0 
                        ? Math.round(categoryWorks.reduce((sum, w) => sum + w.progress, 0) / categoryWorks.length)
                        : 0
                };
            });

            // –ê–Ω–∞–ª–∏–∑ –ø–æ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è–º
            const executors = [...new Set(works.map(w => w.executor))];
            executors.forEach(executor => {
                const executorWorks = works.filter(w => w.executor === executor);
                reportData.executorsAnalysis[executor] = {
                    totalWorks: executorWorks.length,
                    completedWorks: executorWorks.filter(w => w.status === 'completed').length,
                    avgProgress: executorWorks.length > 0 
                        ? Math.round(executorWorks.reduce((sum, w) => sum + w.progress, 0) / executorWorks.length)
                        : 0
                };
            });

            const reportStr = JSON.stringify(reportData, null, 2);
            const blob = new Blob([reportStr], { type: 'application/json' });
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = 'construction_report_' + new Date().toISOString().split('T')[0] + '.json';
            link.click();
            
            showNotification('–ê–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–π –æ—Ç—á–µ—Ç —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω', 'success');
        }

        // === –ú–û–î–ê–õ–¨–ù–´–ï –û–ö–ù–ê ===
        function closeModal(modalId) {
            document.getElementById(modalId).classList.remove('active');
        }

        // === –í–°–ü–û–ú–û–ì–ê–¢–ï–õ–¨–ù–´–ï –§–£–ù–ö–¶–ò–ò ===
        function getEmptyStateMessage() {
            if (globalFilter === 'completed') {
                return {
                    icon: '‚úÖ',
                    title: '–ù–µ—Ç –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—ã—Ö —Ä–∞–±–æ—Ç',
                    description: '–í –≤—ã–±—Ä–∞–Ω–Ω–æ–π –æ–±–ª–∞—Å—Ç–∏ –ø–æ–∫–∞ –Ω–µ—Ç –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—ã—Ö —Ä–∞–±–æ—Ç'
                };
            } else if (globalFilter === 'not-completed') {
                return {
                    icon: '‚è≥',
                    title: '–í—Å–µ —Ä–∞–±–æ—Ç—ã –∑–∞–≤–µ—Ä—à–µ–Ω—ã!',
                    description: '–í—Å–µ —Ä–∞–±–æ—Ç—ã –≤ –≤—ã–±—Ä–∞–Ω–Ω–æ–π –æ–±–ª–∞—Å—Ç–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω—ã'
                };
            } else if (globalFilter === 'overdue') {
                return {
                    icon: 'üö®',
                    title: '–ù–µ—Ç –ø—Ä–æ—Å—Ä–æ—á–µ–Ω–Ω—ã—Ö —Ä–∞–±–æ—Ç',
                    description: '–û—Ç–ª–∏—á–Ω–æ! –í—Å–µ —Ä–∞–±–æ—Ç—ã –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –≤ —Å—Ä–æ–∫'
                };
            } else {
                return {
                    icon: 'üìã',
                    title: '–ù–µ—Ç —Ä–∞–±–æ—Ç',
                    description: '–í –≤—ã–±—Ä–∞–Ω–Ω–æ–π –æ–±–ª–∞—Å—Ç–∏ –Ω–µ—Ç —Ä–∞–±–æ—Ç –∏–ª–∏ –æ–Ω–∏ –Ω–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç –∫—Ä–∏—Ç–µ—Ä–∏—è–º –ø–æ–∏—Å–∫–∞'
                };
            }
        }

        function getStatusText(status) {
            const statusTexts = {
                'not-started': '–ù–µ –Ω–∞—á–∞—Ç–æ',
                'in-progress': '–í –ø—Ä–æ—Ü–µ—Å—Å–µ',
                'completed': '–ó–∞–≤–µ—Ä—à–µ–Ω–æ',
                'overdue': '–ü—Ä–æ—Å—Ä–æ—á–µ–Ω–æ'
            };
            return statusTexts[status] || status;
        }

        function getPriorityText(priority) {
            const priorityTexts = {
                'low': '–ù–∏–∑–∫–∏–π',
                'medium': '–°—Ä–µ–¥–Ω–∏–π',
                'high': '–í—ã—Å–æ–∫–∏–π'
            };
            return priorityTexts[priority] || priority;
        }

        function formatDate(dateString) {
            if (!dateString) return '–ù–µ —É–∫–∞–∑–∞–Ω–æ';
            try {
                return new Date(dateString).toLocaleDateString('ru-RU');
            } catch {
                return dateString;
            }
        }

        function showNotification(message, type) {
            const notification = document.createElement('div');
            notification.className = 'notification ' + (type || 'success');
            notification.textContent = message;
            document.body.appendChild(notification);
            
            setTimeout(() => notification.classList.add('show'), 100);
            setTimeout(() => {
                notification.classList.remove('show');
                setTimeout(() => document.body.removeChild(notification), 300);
            }, 3000);
        }

        // –î–µ–ª–∞–µ–º —Ñ—É–Ω–∫—Ü–∏–∏ –≥–ª–æ–±–∞–ª—å–Ω–æ –¥–æ—Å—Ç—É–ø–Ω—ã–º–∏
        window.addBlock = addBlock;
        window.removeBlock = removeBlock;
        window.addNewWork = addNewWork;
        window.editWork = editWork;
        window.deleteWork = deleteWork;
        window.changeWorkStatus = changeWorkStatus;
        window.quickEditProgress = quickEditProgress;
        window.addNewProject = addNewProject;
        window.editProject = editProject;
        window.deleteProject = deleteProject;
        window.setGlobalFilter = setGlobalFilter;
        window.setCategoryFilter = setCategoryFilter;
        window.changeActiveProject = changeActiveProject;
        window.toggleProject = toggleProject;
        window.toggleBlock = toggleBlock;
        window.selectFloor = selectFloor;
        window.updateProjectFields = updateProjectFields;
        window.updateFloorOptions = updateFloorOptions;
        window.updateWorkTypeOptions = updateWorkTypeOptions;
        window.applySorting = applySorting;
        window.closeModal = closeModal;
        window.openProjectManager = openProjectManager;
        window.selectProjectFromManager = selectProjectFromManager;
        window.exportData = exportData;
        window.generateReport = generateReport;
    </script>
</body>
</html>